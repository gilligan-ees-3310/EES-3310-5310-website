---
title: "Reducing Carbon Emissions:<br/>Bottom-Up Approaches"
class_no: 25
class_date: "Monday, March 22"
qrimage: qrcode.png
pageurl: "ees3310.jgilligan.org/slides/class_25"
pdfurl: "ees3310.jgilligan.org/slides/class_25/ees_3310_5310_class_25_slides.pdf"
course: "EES 3310/5310"
course_name: "Global Climate Change"
author: "Jonathan Gilligan"
semester: Spring
year: 2021
output:
  revealjg::revealjs_presentation
---
```{r setup, cache = F, echo = F, eval = T, message=F, warning=F}
knitr::opts_chunk$set(cache=TRUE, 
                      echo=FALSE, message=FALSE, warning=FALSE,
                      fig.height=9, fig.width=14, dpi=100,
                      dev='png',fig.path='assets/fig/',cache.path='./cache/')

library(rprojroot)

semester_dir <- find_rstudio_root_file()
data_dir <- file.path(semester_dir, "data")
script_dir <- file.path(semester_dir, "lecture_scripts")

source_semester_script <- function(script) {
  script_file <- file.path(script_dir, script)
  message("Running script", script_file)
  source(script_file, chdir = T)
}

eval_in_sem_script_dir <- function(expr, loc = script_dir) {
  this_dir <- getwd()
  setwd(loc)
  retval <- eval(expr)
  setwd(this_dir)
  invisible(retval)
}

library(magrittr)
library(tidyverse)
library(RColorBrewer)
library(broom)
library(readxl)
library(janitor)

library(ggrepel)

library(kayadata)

source_semester_script('lecture_utils.R')
theme_set(theme_bw(base_size = 20))
```
```{r energy_data, echo=F, eval=T, cache=T}
# Renewable Energy Parity Network for the 21st Century
# Global Status Report 2020
# http://www.ren21.net/status-of-renewables/global-status-report/
global_wind <- tibble(
  year = seq(1990,2019),
  wind = c(
      2.4,   2.7,   3.0,   3.1,   3.8,   4.9,   6.0,   7.0,   9.7,  13.0,  
     17.5,  24.3,  31.1,  39.2,  47.5,  59.1,  74.0,  93.8, 121.0, 159.1, 
    198.0, 238.1, 282.9, 318.7, 369.9, 432.7, 488.0, 540.0, 591.0, 651.0
  )
) %>% gather(-year, key = technology, value = installed.gw)

global_renewables <- tibble(
  year = seq(2005,2019),
  wind = c(
                                        59,    74,    94,   121,   159,   
    198,   238,   283,   318,   370,   433,   487,   540,   591,   651
  ),
  solar = c(
                                       5.1,   6.0,   8.0,   15.0,  23.0,  
   40.0,  71.0, 101.0, 138.0, 178.0, 228.0, 306.0, 409.0,  512.0, 627.0
  )
) %>% gather(-year, key = technology, value = installed.gw) %>%
  mutate(technology = ifelse(technology == 'solar', 'Solar PV', 
                             ifelse(technology == 'wind', 'Wind', technology)))

solar_by_country <- tibble(
  country = c("China", "United States", "Japan", "Germany", "Italy", 
              "India", "United Kingdom", "France", "Australia", "Spain",
              "Vietnam", "Ukraine", "South Korea"),
  technology = "Solar PV",
  installed.2019 = c(204.7, 76.0, 63.0, 49.0,   NA, 42.8,   NA,  NA, 14.7, 10.3,
                       4.9,  4.8, 11.2),
  added.2019     = c( 30.1, 13.3,  7.0,  3.8,   NA,  9.0,   NA,  NA,  3.7,  4.7,
                       4.8,  3.5,  3.1),
  installed.2018 = c(176.1, 62.4, 56.0, 45.3, 20.1, 32.9, 13.0, 9.0, 11.0,  5.6,
                       0.1,  1.3,  8.1),
  added.2018     = c( 45.0, 10.6,  6.5,  3.0,  0.4, 10.8,  0.3, 0.9,  3.8,  0.0,
                        NA,   NA,   NA),
  installed.2017 = c(131.1, 51.8, 49.5, 42.3, 19.7, 22.1, 12.7, 8.1,  7.2,  5.6,
                        NA,   NA,   NA),
  added.2017     = c( 53.1, 10.6,  7.0,  1.7,  0.4,  9.1,  0.9, 0.9,  1.2,  0.1,
                        NA,   NA,   NA),
  installed.2016 = c( 78.1, 40.4, 42.0, 40.7, 19.3,  9.2, 11.8, 7.1,  6.0,  5.5,
                        NA,   NA,   NA),
  added.2016     = c( 34.5, 14.8,  8.6,  1.5,  0.4,  4.1,  2.0, 0.6,  0.9,  0.1,
                        NA,   NA,   NA)
) %>%
  mutate(installed.2018 = ifelse(is.na(installed.2019), installed.2018,
                                 installed.2019 - added.2019),
         installed.2017 = ifelse(is.na(installed.2018), installed.2017,
                                 installed.2018 - added.2018),
         installed.2016 = ifelse(is.na(installed.2017), installed.2016,
                                 installed.2017 - added.2017),
         installed.2015 = installed.2016 - added.2016)

wind_by_country <- tibble(
  country = c("China", "United States", "Germany", "India", "Spain", 
              "United Kingdom", "France", "Brazil", "Canada", "Italy",
              "Sweden", "Mexico", "Argentina"),
  technology = "Wind",
  installed.2019 = c(236.4, 105.6, 61.4, 37.5, 25.8, 23.5, 16.6,   NA,   NA,   NA,
                       9.0,   6.2,  1.6
                     ),
  added.2019     = c( 26.2,   9.1,  2.1,  2.4,  2.3,  2.4, 1.3,    NA,   NA,   NA,
                       1.6,   1.3,  0.9
                     ),
  installed.2018 = c(210.0,  96.5, 59.3, 35.1, 23.5, 21.0, 15.3, 14.7, 12.8, 10.0,
                        NA,    NA,   NA
                     ),
  added.2018     = c( 21.1,   7.6,  3.1,  2.2,  0.4,  1.9,  1.6,  1.9,  0.6,  0.5,
                        NA,    NA,   NA
                     ),
  installed.2017 = c(188.4,  89.0, 56.2, 32.9, 23.1, 19.1, 13.8, 12.8, 12.2,  9.5,
                        NA,    NA,   NA
                     ),
  added.2017     = c( 19.7,   7.0,  6.1,  4.1,  0.1,  4.3,  1.7,  2.0,  0.3,  0.3,
                        NA,    NA,   NA
                      ),
  installed.2016 = c(168.7,  82.0, 50.0, 28.7, 23.1, 14.6, 10.7, 11.9, 10.7,  9.2,
                        NA,    NA,   NA
                     ),
  added.2016     = c( 23.4,   8.2,  5.0,  3.6,  0.0,  0.7,  1.6,  0.7,  2.0,  0.3,
                        NA,    NA,   NA
                      )
) %>% 
  mutate(installed.2018 = ifelse(is.na(installed.2019), installed.2018,
                                 installed.2019 - added.2019),
         installed.2017 = ifelse(is.na(installed.2018), installed.2017,
                                 installed.2018 - added.2018),
         installed.2016 = ifelse(is.na(installed.2017), installed.2016,
                                 installed.2017 - added.2017),
         installed.2015 = installed.2016 - added.2016)
```
# Challenges of Decarbonizing {#decarb-challenge-sec .center}

## Scale of Problem:<br/>450 ppm target {#scale-of-problem}

![Convergence and Contraction](assets/images/ice_final_pics_convergence_and_contraction_01.png){height=725}

## Pielke's Policy Criteria {#pielke-policy-criteria .center}

1. Policies should flow with public opinion
1. Public will not tolerate significant short-term costs, 
   even for big long-term benefits
1. Policy must center on clean energy innovation

# Solar Photovoltaic Power {.blacktitle #solar-sec data-background-image="assets/images/solar_panels.jpg" data-backfround-position="contain"}

## Solar Energy over Time {#solar-time data-background-image="assets/images/solar_panels.jpg" data-backfround-position="contain"}

::::::{.bare .mtop-3}
```{r solar_time, dependson='energy_data'}
global_renewables %>% filter(technology == 'Solar PV') %>%
ggplot(aes(x = year, y = installed.gw)) + 
  geom_point(size = 3) + geom_line(size = 1) + 
  scale_x_continuous(breaks = seq(1980, 2020, 5)) +
  labs(x = "Year", y = "Installed Capacity (GW)", title = "Installed Solar Photovoltaic Capacity")
```

::: {.credit .yellowtext}
Renewable Energy Parity Network for the 21st Century,
_Global Status Report 2020_,
<http://www.ren21.net/status-of-renewables/global-status-report/>
:::
::::::

## Top-10 Nations for Solar PV {#solar-top-10 data-background-image="assets/images/solar_panels.jpg" data-backfround-position="contain"}

::::::{.bare .mtop-3}
```{r solar_top_10, dependson='energy_data', include=FALSE, eval=FALSE}
solar_by_country %>% arrange(desc(installed.2019)) %>% 
  mutate(country = ordered(country, levels = country)) %>% 
  select(country, installed.2018, added.2019) %>% 
  gather(-country, key = category, value = value) %>% 
  mutate(category = ordered(category, levels = c('added.2019', 'installed.2018'),
                            labels = c('Added in 2019', 'Total in 2018'))) %>% 
  ggplot(aes(x = country, y = value, fill = category)) + 
  geom_bar(stat = 'identity') + 
  scale_fill_manual(values = brewer.pal(9, 'YlOrRd')[3:4], 
                    breaks = c('Added in 2019', 'Total in 2018'), name = '') + 
  labs(x = NULL, y = 'Solar PV Capacity (GW)')+ 
  theme_bw(base_size = 25) + 
  theme(panel.grid.major.x = element_blank(),
        axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1), 
        legend.position = c(1,1), legend.justification = c(1,1))
```
```{r solar_top_10_alt, dependson="energy_data"}
solar_by_country %>% arrange(desc(installed.2019)) %>% 
  mutate(country = ordered(country, levels = country),
         installed.2017 = ifelse(is.na(installed.2017), 
                                 installed.2019 - added.2019 - 
                                   replace_na(added.2018, 0.0),
                                 installed.2017),
         added.18_19 = installed.2019 - installed.2017) %>% 
  select(country, installed.2017, added.18_19) %>% 
  filter(! is.na(added.18_19)) %>%
  gather(-country, key = category, value = value) %>% 
  mutate(category = ordered(category, 
                            levels = c('added.18_19', 'installed.2017'),
                            labels = c('Added in 2018-19', 'Total in 2017'))) %>% 
  ggplot(aes(x = country, y = value, fill = category)) + 
  geom_bar(stat = 'identity') + 
  scale_y_continuous(limits = c(0,NA),
                     expand = expansion(mult = c(0.0, 0.05), 
                                        add = c(0.0, 0.0))) +
  scale_fill_manual(values = brewer.pal(9, 'YlOrRd')[3:4], 
                    breaks = c('Added in 2018-19', 'Total in 2017'), 
                    name = '') + 
  labs(x = NULL, y = 'Solar PV Capacity (GW)')+ 
  theme_bw(base_size = 25) + 
  theme(panel.grid.major.x = element_blank(),
        axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1), 
        legend.position = c(0.99,0.99), legend.justification = c(1,1))
```

::: {.credit .yellowtext}
Renewable Energy Parity Network for the 21st Century,
_Global Status Report 2020_,
<http://www.ren21.net/status-of-renewables/global-status-report/>
:::
::::::

# Wind Power {#wind-sec .yellowtitle data-background-image="assets/images/1280px-A_close_shot_of_wind_turbines_wind_farm.jpg" data-backfround-position="contain"}

## Wind Energy over Time {#wind-time data-background-image="assets/images/1280px-A_close_shot_of_wind_turbines_wind_farm.jpg" data-backfround-position="contain" data-background-color="white" data-background-opacity=0.3}

::::::{.bare .mtop-3}
```{r wind_time, dependson='energy_data'}
global_wind %>% 
ggplot(aes(x = year, y = installed.gw)) + 
  geom_point(size = 3) + geom_line(size = 1) + 
  scale_x_continuous(breaks = seq(1980, 2020, 5)) +
  labs(x = "Year", y = "Installed Capacity (GW)", title = "Installed Wind Capacity")
```

::: {.credit .blacktext}
Renewable Energy Parity Network for the 21st Century,
_Global Status Report 2020_,
<http://www.ren21.net/status-of-renewables/global-status-report/>
:::
::::::

## Top-10 Nations for Wind {#wind-top-10 data-background-image="assets/images/1280px-A_close_shot_of_wind_turbines_wind_farm.jpg" data-backfround-position="contain" data-background-color="white" data-background-opacity=0.3}

::::::{.bare .mtop-3}
```{r wind_top_10, dependson='energy_data', include = FALSE, eval = FALSE}
wind_by_country %>% arrange(desc(installed.2019)) %>% 
  mutate(country = ordered(country, levels = country)) %>% 
  select(country, installed.2018, added.2019) %>% 
  gather(-country, key = category, value = value) %>% 
  mutate(category = ordered(category, levels = c('added.2019', 'installed.2018'),
                            labels = c('Added in 2019', 'Total in 2018'))) %>% 
  ggplot(aes(x = country, y = value, fill = category)) + 
  geom_bar(stat = 'identity') + 
  scale_fill_manual(values = brewer.pal(9, 'YlOrRd')[3:4], 
                    breaks = c('Added in 2019', 'Total in 2018'), name = '') + 
  labs(x = NULL, y = 'Wind Power Capacity (GW)') + 
  theme_bw(base_size = 25) + 
  theme(panel.grid.major.x = element_blank(),
        axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1), 
        legend.position = c(1,1), legend.justification = c(1,1))
```
```{r wind_top_10_alt, dependson="energy_data"}
wind_by_country %>% arrange(desc(installed.2019)) %>% 
  mutate(country = ordered(country, levels = country),
         installed.2017 = ifelse(is.na(installed.2017), 
                                 installed.2019 - added.2019 - 
                                   replace_na(added.2018, 0.0),
                                 installed.2017),
         added.18_19 = installed.2019 - installed.2017) %>% 
  select(country, installed.2017, added.18_19) %>% 
  filter(! is.na(added.18_19)) %>%
  gather(-country, key = category, value = value) %>% 
  mutate(category = ordered(category, 
                            levels = c('added.18_19', 'installed.2017'),
                            labels = c('Added in 2018-19', 'Total in 2017'))) %>% 
  ggplot(aes(x = country, y = value, fill = category)) + 
  geom_bar(stat = 'identity') + 
  scale_y_continuous(limits = c(0,NA),
                     expand = expansion(mult = c(0.0, 0.05), 
                                        add = c(0.0, 0.0))) +
  scale_fill_manual(values = brewer.pal(9, 'YlOrRd')[3:4], 
                    breaks = c('Added in 2018-19', 'Total in 2017'), 
                    name = '') + 
  labs(x = NULL, y = 'Wind Power Capacity (GW)')+ 
  theme_bw(base_size = 25) + 
  theme(panel.grid.major.x = element_blank(),
        axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1), 
        legend.position = c(0.99,0.99), legend.justification = c(1,1))
```

::: {.credit .blacktext}
Renewable Energy Parity Network for the 21st Century,
_Global Status Report 2020_,
<http://www.ren21.net/status-of-renewables/global-status-report/>
:::
::::::

# Prospects for Future Renewable Energy {#renewable-future .center}

## Solar PV {#pv-prices}

![Solar cost decreased 99.9% since 1976](assets/images/solar-pv-prices-vs-cumulative-capacity.png){height=900}

## Cost of Renewable Energy vs. Fossil Fuels

![Chart of prices for renewable electricity vs. Fossil fuels](assets/images/Price-of-electricity-new-renewables-vs-new-fossil-no-geo.png){height=900}

::: notes

The cost of solar electricity dropped `r scales::label_percent(accuracy=1)(1 - 40 / 359)` in
the last 10 years.

The cost of wind power dropped `r scales::label_percent(accuracy=1)(1 - 41/135)` in
the last 10 years.

:::


## Current World Mix of Energy {#current-mixy}

::::::{.bare .mtop-3}
![Current World Energy Mix](assets/images/energy_breakdown.jpg){height=750}

::: {.credit}
Renewable Energy Parity Network for the 21st Century,
_Global Status Report 2020_,
<http://www.ren21.net/status-of-renewables/global-status-report/>
:::
::::::

## World Electricity Generation {#electricity-mix}

::::::{.bare .mtop-3}
![World Electricity Mix](assets/images/electricity_breakdown.jpg){height=750}

::: {.credit}
Renewable Energy Parity Network for the 21st Century,
_Global Status Report 2020_,
<http://www.ren21.net/status-of-renewables/global-status-report/>
:::
::::::

# Decarbonizing the World {#decarbonizing-sec .center}

## Implied Decarbonization: {#decarbonization-intro .eighty .leftslide}

* Goal:
  * Reduce emissions to some percentage below a reference year,
    by a target year
  * Example: Reduce emissions so _F_(2050) is 80% less than _F_(1990).
* {+} Bottom-up procedure:
  * Treat each Kaya identity factor separately: _P_, _g_, _e_, _f_.
    * e.g., **extrapolate each factor**, based on historical rate of change
  * Combine _P_ and _g_ to get _G_ (GDP in target year)
* {+} Top-down procedure:
  * Begin with integrated model of total GDP growth
    * e.g., **macroeconomic model** that considers interactions between
      _P_, _g_, _e_, and _f_.
    * {+} _F_ = total CO~2~ emissions
    * {+} _G_ = _Pg_ is Gross Domestic Product: Size of the economy
    * {+} _ef_ = carbon intensity of the economy
    * {+} If _ef_ rapidly gets smaller, then we can have economic growth while 
      reducing emissions.

## Implied Decarbonization (Bottom Up) {#implied-bottom-up .ninety}

* {+} We know _F_ and _G_ at the start.
* {+} We know the goal for _F_ at the target date
* {+} We predict what _P_ and _g_ will be at the target date
* {+} Kaya Identity:

  $$ 
  \begin{align*}
    F   &= P \times g \times e \times f \\
        &= G \times ef \\
    F/G &= ef
  \end{align*}
  $$

* {+} Change if $F/G$ implies change in $ef$: decarbonization.
    * $\Delta (F/G) = \Delta (ef)$
* {+} Achieve decarbonization by some mix of energy efficiency (reduce _e_)
  and adoption of clean energy (reduce _f_).

## Implied Decarbonization (Top Down) {#implied-top-down .ninety}

* {+} We know _F_ and _E_ at the start.
* {+} We know the goal for _F_ at the target date
* {+} We predict what energy consumption _E_ will be at the target date
* {+} Kaya Identity:
  $$ 
  \begin{align*}
    F   &= E \times f \\
    F/E &= f
  \end{align*}
  $$
* {+} Change if $F/E$ implies change in $f$: decarbonization.
    * $\Delta (F/E) = \Delta (f)$
* {+} Achieve decarbonization by adopting clean energy (reduce _f_).

# Worked Example: UK {#bottom-up-uk-sec .center}

## UK Climate Change Act (2008) {#uk-climate-act .center}

* Reduce greenhouse gas emissions so<br/>*F* in 2050 is 80% lower than in 1990:
  [\[ F(2050) = 0.20\: F(1990) \]]{style="font-size:95%;"}
* How hard will it be to achieve this goal?

## Bottom-Up Analysis

* Begin by figuring historical rates of change<br/>for $P$, $g$, $e$, and $f$.
* Estimate historical growth rate for $P \times g$.
* Calculate implied rate of change for $e \times f$.
* Compare implied rate of change for $ef$ to historical rate of change.
* Use on-line web application to calculate<br/>rates of change.
  <https://ees3310.jgilligan.org/decarbonization/>
  * R package `kayadata`: `install.packages("kayadata")`

## Bottom-Up Analysis {#bottom-up-uk-app}

<iframe src="https://ees3310.jgilligan.org/decarbonization" height=900, width=1600>
<a href="https://ees3310.jgilligan.org/decarbonization", target="_blank">https://ees3310.jgilligan.org/decarbonization</a>
</iframe>

:::{.bare .eighty}
<https://ees3310.jgilligan.org/decarbonization>
:::

## Bottom-Up Analysis {#bottom-up-uk-1 .eighty}
```{r calc_uk_decarbonization}
policy_start_year = 2008
nat_data <- get_kaya_data("United Kingdom")
new_nat_data <- nat_data %>% 
  filter(year > policy_start_year)
nat_data <- nat_data %>% filter(year <= policy_start_year)
target_year = 2050
ref_year = 1990
trend_start_year = 1980
reduction = 0.80

last_year <- max(nat_data$year, na.rm = TRUE)
delta_t = target_year - last_year

F_ref  = nat_data %>% filter(year == ref_year) %$% F
F_last = nat_data %>% filter(year == last_year) %$% F
F_target = F_ref * (1 - reduction)

r_P = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(P) ~ year, data = .) %>%  
  tidy() %>% filter(term == "year") %$% estimate
r_g = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(g) ~ year, data = .) %>% 
  tidy() %>% filter(term == "year") %$% estimate
r_G = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(G) ~ year, data = .) %>% 
  tidy() %>% filter(term == "year") %$% estimate
r_ef_hist = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(ef) ~ year, data = .) %>% 
  tidy() %>% filter(term == "year") %$% estimate

G_last = nat_data %>% filter(year == last_year) %$% G
G_target = G_last * exp(r_G * delta_t)

r_F = log(F_target / F_last) / delta_t
r_ef = r_F - r_G

ef_last = nat_data %>% filter(year == last_year) %$% ef
```
* {+} GDP(`r last_year`) = $`r prt(G_last, 2)` trllion
  * Emissions intensity *ef*(`r last_year`) = `r prt(ef_last, 0)` tons per $1000
* {+} Business as usual:
  * If growth follows historical trends
    * {+} Population _P_ grows at `r prt(r_P * 100, 2)`%,
    * {+} per-capita GDP _g_ grows at `r prt(r_g * 100, 2)`%,
    * {+} GDP grows at `r prt(r_P * 100, 2)`% + `r prt(r_g * 100, 2)`% = `r prt(r_G * 100, 2)`%
    
      [\(\displaystyle
      \begin{aligned}
      GDP(`r target_year`) &= GDP(`r last_year`) \times \exp(`r prt(r_G, 4)` \times (`r target_year` - `r last_year`))\\
      &= \$`r prt(G_last,2)`~\text{trillion} \times \exp(`r prt(r_G, 4)` \times `r delta_t`)\\
      &= \$`r prt(G_target, 2)`~{\text{trillion}}
      \end{aligned}
      \)]{style="font-size:95%;"}

## Bottom-Up Analysis {#bottom-up-uk-2 .eighty}

* {+} F(`r last_year`) = `r prt(F_last, 0)` million tons CO~2~.
* {+} F(`r ref_year`) = `r prt(F_ref, 0)` million tons CO~2~.
* {+} Goal: Emissions in 2050 are 80% less than in 1990:
    * {+} [$F(`r target_year`) = `r prt(1 - reduction, digits = 2)`\: F(`r ref_year`) = `r prt(1 - reduction, digits = 2)` \times `r prt(F_ref, 0)`~\text{MMT} = `r prt(F_target,0)`~\text{MMT}$]{style="font-size:95%;"}
    * {+} Implied growth rate of $F$:

      [\(\displaystyle
      \begin{aligned}
      r_F &= \ln(F(`r target_year`) / F(`r last_year`)) / `r delta_t`~\text{years} \\
      &= \ln(`r prt(F_target,0)` / `r prt(F_last,0)`) / `r delta_t` \\
      &= `r prt(100 * log(F_target / F_last) / delta_t, 2)`\%.
      \end{aligned}
      \)]{style="font-size:95%;"}

## Implied decarbonization rates:  {#bottom-up-uk-3 .eighty}

* {+} GDP ([$P \times g$]{style="font-size:95%;"}) grows at `r prt(100 * r_G, 2)`%
* {+} Implied growth rate of _F_: $r_F = `r prt(r_F * 100,2)`\%$.
* {+} Implied growth rate of _ef_ (carbon intensity of the economy):
  * $F = Pgef$, so 
  * $r_F = r_{Pg} + r_{ef} = r_G + r_{ef}$

    [\(\displaystyle
    \begin{aligned}
    r_{ef} &= r_F - r_G \\
    &= `r prt(r_F * 100,2)`\% - `r prt(r_G * 100, 2)`\%\\
    &= `r prt(r_ef * 100, 2)`\%
    \end{aligned}
    \)]{style="font-size:95%;"}
* {+} The implied $r_{ef} = `r prt(r_ef * 100, 2)`\%$
* {+} The historical $r_{ef} = `r prt(r_ef_hist * 100, 2)`\%$
* {+} To meet the goal, the UK would have to decarbonize `r prt(abs(r_ef) / abs(r_ef_hist), 1)` 
  times faster than it did for the previous several decades.
* {+} However, since 2010, decarbonization has accelerated!

## Implied decarbonization for UK {#bottom-up-uk-4 .eighty}

```{r implied_decarb_uk, warning=FALSE, message=FALSE, dependson="calc_uk_decarbonization"}
df <- nat_data %>% select(year, ef) %>% filter(year >= trend_start_year)
model <- lm(log(ef) ~ year, data = df)
df <- df %>% bind_rows(tibble(year = seq(last_year + 1, target_year))) %>%
  augment(x = model, newdata = .) %>%
  select(year, ef, trend = .fitted) %>%
  mutate(bottom_up = exp((year - last_year) * r_ef) * ef_last,
         trend = exp(trend)) %>%
  pivot_longer(-year, names_to = "var", values_to = "ef") %>%
  filter(var != "bottom_up" | year >= last_year) %>%
  mutate(var = ordered(var, levels = c("ef", "trend", "bottom_up"),
                       labels = c("Historical", "Historical Trend",
                                  "Bottom Up"))) %>%
  filter(! is.na(ef)) %>%
  arrange(var, year)
```
```{r implied_decarb_plot_uk, warning = FALSE, message = FALSE, dependson="implied_decarb_uk"}
ggplot(df, aes(x = year, y = ef, color = var)) + 
  geom_line(size = 1) + 
  geom_point(size = 3) + 
  scale_color_manual(values = brewer.pal(n = 3, "Dark2")[c(2, 3, 1)], 
                     name = NULL) +
  scale_x_continuous(breaks = seq(1900, 2100, 10), 
                     limits = c(trend_start_year, target_year + 3),
                     expand = c(0, 0)) +
  labs(x = "Year", y = expression(paste(CO[2], " intensity (tons / $million)"))) + 
  theme_bw(base_size = 20) + 
  theme(legend.position = c(0.99, 0.99),
        legend.justification = c(1, 1))
```

## Progress since `r policy_start_year`

```{r newer_uk_comparison, warhing=FALSE, message=FALSE, dependson="implied_decarb_plot_uk"}
recent_data <- new_nat_data %>% select(year, ef) %>%
  mutate(var = ordered("Historical", levels = levels(df$var)))

df %>% bind_rows(recent_data) %>%
  arrange(var, year) %>%
  ggplot(aes(x = year, y = ef, color = var)) + 
  geom_line(size = 1) + 
  geom_point(size = 3) + 
  scale_color_manual(values = brewer.pal(n = 3, "Dark2")[c(2, 3, 1)], 
                     name = NULL) +
  scale_x_continuous(breaks = seq(1900, 2100, 10), 
                     limits = c(trend_start_year, target_year + 3),
                     expand = c(0, 0)) +
  labs(x = "Year", y = expression(paste(CO[2], " intensity (tons / $million)"))) + 
  theme_bw(base_size = 20) + 
  theme(legend.position = c(0.99, 0.99),
        legend.justification = c(1, 1))
```


# Implied Decarbonization<br/>for Australia {#bottom-up-australia-sec .center}

## Australia's<br/>Emissions Trading Scheme {#bottom-up-australia-1}
```{r calc_aus_decarbonization}
policy_start_year = 2008
nat_data <- get_kaya_data("Australia")
new_nat_data <- nat_data %>% 
  filter(year > policy_start_year)
nat_data <- nat_data %>% filter(year <= policy_start_year)
target_year = 2050
ref_year = 2000
trend_start_year = 1980
reduction = 0.60

last_year <- max(nat_data$year, na.rm = TRUE)
delta_t = target_year - last_year

F_ref  = nat_data %>% filter(year == ref_year) %$% F
F_last = nat_data %>% filter(year == last_year) %$% F
F_target = F_ref * (1 - reduction)

r_P = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(P) ~ year, data = .) %>%  
  tidy() %>% filter(term == "year") %$% estimate
r_g = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(g) ~ year, data = .) %>% 
  tidy() %>% filter(term == "year") %$% estimate
r_G = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(G) ~ year, data = .) %>% 
  tidy() %>% filter(term == "year") %$% estimate
r_ef_hist = nat_data %>% filter(year >= trend_start_year) %>% 
  lm(log(ef) ~ year, data = .) %>% 
  tidy() %>% filter(term == "year") %$% estimate

G_last = nat_data %>% filter(year == last_year) %$% G
G_target = G_last * exp(r_G * delta_t)

r_F = log(F_target / F_last) / delta_t
r_ef = r_F - r_G

ef_last = nat_data %>% filter(year == last_year) %$% ef
```

* PM Kevin Rudd calls for cutting emissions 60% below 2000 levels by 2050
* [$F(`r target_year`) = `r prt(1 - reduction, 2)`\: 
  F(`r ref_year`) = `r prt(1 - reduction, 2)` \times 
  `r prt(F_ref, 0)`~\text{MMT} = `r prt(F_target, 0)`~\text{MMT}$]{style="font-size:95%;"}

## Implied Decarbonization for Australia {#bottom-up-australia-2 .eighty}

* Historical decarbonization rate: $r_{ef} = `r prt(100 * r_ef_hist,2)`\%$
* Implied decarbonization rate: $r_{ef} = `r prt(100 * r_ef, 2)`\%$

```{r implied_decarb_oz, warning=FALSE, message=FALSE}
df <- nat_data %>% select(year, ef) %>% filter(year >= trend_start_year)
model <- lm(log(ef) ~ year, data = df)
df <- df %>% bind_rows(tibble(year = seq(last_year + 1, target_year))) %>%
  augment(x = model, newdata = .) %>%
  select(year, ef, trend = .fitted) %>%
  mutate(bottom_up = exp((year - last_year) * r_ef) * ef_last,
         trend = exp(trend)) %>%
  pivot_longer(-year, names_to = "var", values_to = "ef") %>%
  filter(var != "bottom_up" | year >= last_year) %>%
  mutate(var = ordered(var, levels = c("ef", "trend", "bottom_up"),
                       labels = c("Historical", "Historical Trend",
                                  "Bottom Up"))) %>%
  filter(! is.na(ef)) %>%
  arrange(var, year)
```
```{r implied_decarb_plot_oz, warning = FALSE, message = FALSE, fig.height=8}
ggplot(df, aes(x = year, y = ef, color = var)) + 
  geom_line(size = 1) + 
  geom_point(size = 3) + 
  scale_color_manual(values = brewer.pal(n = 3, "Dark2")[c(2, 3, 1)], 
                     name = NULL) +
  scale_x_continuous(breaks = seq(1900, 2100, 10), 
                     limits = c(trend_start_year, target_year + 3),
                     expand = c(0, 0)) +
  labs(x = "Year", y = expression(paste(CO[2], " intensity (tons / $million)"))) + 
  theme_bw(base_size = 20) + 
  theme(legend.position = c(0.99, 0.99),
        legend.justification = c(1, 1))
```

## Progress since `r policy_start_year`

```{r newer_oz_comparison, warhing=FALSE, message=FALSE, dependson="implied_decarb_plot_uk"}
recent_data <- new_nat_data %>% select(year, ef) %>%
  mutate(var = ordered("Historical", levels = levels(df$var)))

df %>% bind_rows(recent_data) %>%
  arrange(var, year) %>%
  ggplot(aes(x = year, y = ef, color = var)) + 
  geom_line(size = 1) + 
  geom_point(size = 3) + 
  scale_color_manual(values = brewer.pal(n = 3, "Dark2")[c(2, 3, 1)], 
                     name = NULL) +
  scale_x_continuous(breaks = seq(1900, 2100, 10), 
                     limits = c(trend_start_year, target_year + 3),
                     expand = c(0, 0)) +
  labs(x = "Year", y = expression(paste(CO[2], " intensity (tons / $million)"))) + 
  theme_bw(base_size = 20) + 
  theme(legend.position = c(0.99, 0.99),
        legend.justification = c(1, 1))
```


# Other Considerations {#other-considerations-sec .center}

## Kuznets curve {#kuznets-curve}
```{r kuznets}
kuznets <- tibble(x = seq(0,200)) %>% mutate(y = x * (1 - x / 200))
ggplot(kuznets, aes(x = x, y = y)) +
  geom_line(size = 1, color = 'dark blue') +
  scale_x_continuous(breaks = NULL) +
  scale_y_continuous(breaks = NULL) +
  labs(x = "Income", y = "Pollution", title = "Kuznets Curve") +
  theme_bw(base_size = 30)
                                             
```

## Concluding Remarks {#conclusion .center}

* {+} Implied $ef$ depends on prediction of $\text{GDP} = G = P \times g$.
* {+} Predicting population and economic growth are very tricky and imprecise.
* {+} So take any of these calculations with a grain of salt.
* {+} But are they still useful, despite the uncertainties?
