---
title: "The Kaya Identity: Energy Use, Conservation and Efficiency"
class_no: 24
class_date: "Friday, March 19"
qrimage: qrcode.png
pageurl: "ees3310.jgilligan.org/slides/class_24"
pdfurl: "ees3310.jgilligan.org/slides/class_24/ees_3310_5310_class_24_slides.pdf"
course: "EES 3310/5310"
course_name: "Global Climate Change"
author: "Jonathan Gilligan"
semester: Spring
year: 2021
output:
  revealjg::revealjs_presentation
---
```{r setup, cache = F, echo = F, eval = T, message=F, warning=F}
knitr::opts_chunk$set(cache=TRUE, 
                      echo=FALSE, message=FALSE, warning=FALSE,
                      fig.height=9, fig.width=14, dpi=100,
                      dev='png',fig.path='assets/fig/',cache.path='./cache/')

library(rprojroot)

semester_dir <- find_rstudio_root_file()
data_dir <- file.path(semester_dir, "data")
script_dir <- file.path(semester_dir, "lecture_scripts")

source_semester_script <- function(script) {
  script_file <- file.path(script_dir, script)
  message("Running script", script_file)
  source(script_file, chdir = T)
}

eval_in_sem_script_dir <- function(expr, loc = script_dir) {
  this_dir <- getwd()
  setwd(loc)
  retval <- eval(expr)
  setwd(this_dir)
  invisible(retval)
}

library(magrittr)
library(tidyverse)
library(broom)
# library(lubridate)
# library(ggthemes)
# library(RColorBrewer)
library(readxl)
library(janitor)

library(ggrepel)
# library(grid)
# library(gtable)
# library(gridExtra)

library(kayadata)

source_semester_script('lecture_utils.R')
source_semester_script('maddison_kaya.R')
```
# Myth 3:<br/>We have all<br/>the technology we need. {#myth-3 .center}


## Do we have the technology? {#wedges data-transition="fade"}

:::::: {.bare .mtop-3}
![](assets/images/issue20wedges8.jpg){style="height:900px;"}

::: {.credit}
Image credit: S. Pacala & R. Socolow, _Science_ **305**, 968 (2004). 
[doi: 10.1126/science.1100103](https://doi.org/10.1126/science.1100103)
:::
::::::

## Do we have the technology? {#dangerous-assumptions .ninety data-transition="fade-in"}

:::::: {.bare .mtop-3}
![](assets/images/pielke_cumulative_emissions.jpg){style="height:775px;"}

::: {.credit}
R.A. Pielke, Jr. <i>et al.</i>, Nature <b>452</b>, 531 (2008).
[doi: 10.1038/452531a](https://doi.org/10.1038/452531a)
:::
::::::
::: {.eighty}
* Blue = Assumed spontaneous emissions reduction
* Brown = Regulations
* Yellow = Allowed emissions to stabilize CO<sub style="font-size:60%;">2</sub> at 550 ppm.
:::

## Optimism on energy efficiency {#pielke-kaya .center .ninety}

:::::: {.bare .mtop-3}
![](assets/images/pielke_assumed_decarbonization.jpg){style="height:900px;"}

::: {.credit}
R.A. Pielke, Jr. <i>et al.</i>, Nature <b>452</b>, 531 (2008).
[doi: 10.1038/452531a](https://doi.org/10.1038/452531a)
:::
::::::

## The View from 2018: {#gilligan-kaya}

* Pielke's numbers focus on 2000--2005
    * The years when China's economy began really rapid growth
* After 2005, things changed:

:::::: {.columns}
::: {.column}
```{r post_2005_e, echo=F, message=F, warning=F, fig.height=7, fig.width=9}
get_kaya_data("World") %>% filter(year >= 1980) %>%
  plot_kaya("e", y_lab = "quad / $ trillion", log_scale = TRUE,
            start_year = 2000, stop_year = 2005) +
  labs(title = "Energy intensity of world economy") +
  scale_y_log10(breaks = seq(6, 11, 2)) +
  theme_bw(base_size = 15)
```
:::
::: {.column}
```{r post_2005_f, echo=F, message=F, warning=F, fig.height=7, fig.width=9}
get_kaya_data("World") %>% filter(year >= 1980) %>%
  plot_kaya("f", y_lab = expression(paste(MMT * CO[2] / quad)), log_scale = TRUE,
            start_year = 2000, stop_year = 2005) +
  labs(title = "Carbon intensity of world energy supply") +
  # scale_y_log10(breaks = seq(62, 78, 4)) +
  theme_bw(base_size = 15) 
```
:::
::::::


## Current Emissions Pathways {#rcps}

:::::: {.columns}
::: {.column}

```{r rcp_data}
data_file <- file.path(data_dir, "ghg_emissions", "GCAMRCPData.xls")

rcp_45   <- read_excel(data_file, 'RCP4.5') %>% clean_names()
gcam_60  <- read_excel(data_file, 'GCAM6.0') %>% clean_names()
gcam_85  <- read_excel(data_file, 'GCAM8.5') %>% clean_names()
gcam_26  <- read_excel(data_file, 'GCAM2.6') %>% clean_names()
gcam_ref <- read_excel(data_file, 'GCAMReference') %>% clean_names()
gcam_by_sector <- read_excel(data_file, 'CO2EmissionsbySector') %>% clean_names()

#
# Clean up a list of variables by converting them into legal names
#
clean_vars <- function(vv) {
  new_vv <- vv %>%
    str_replace_all(c("['\"]" = "", "%" = "percent", "^[ ]+" = "_")) %>%
    make.names() %>%
    str_replace_all(c("[._]+" = "_", "_+$" = "")) %>% str_to_lower()
}

#
# The excel sheet runs years in columns and variables in rows.
# Flip this to put years in columns (and we need to fix "x2008" type col names
# and convert years to integers), and clean up variable names to make them
# legal column names.
#
process_scenario <- function(df) {
  df %>% gather(key = "year", value = "value", -model, -scenario, -region, 
                -variable, -unit) %>%
    mutate(year = str_replace_all(year, "^[^0-9]+", "") %>% as.integer()) %>%
    mutate(variable = clean_vars(variable))
}

for(s in c('gcam_26', 'rcp_45', 'gcam_60', 'gcam_85', 'gcam_ref', 'gcam_by_sector')) {
  get(s) %>% process_scenario() %>% assign(x = s, value = ., pos = globalenv())
}

all_scenarios <- rbind(gcam_26, rcp_45, gcam_60, gcam_85, gcam_ref)

#
# There are lots of variables. We're interested in the Kaya ones, so filter
# those out, and change the names to the ones we want.
# Change scenario names to what we want.
# Then add up values for each region to get whole world numbers.
#
gcam_scenarios <- all_scenarios %>%
  filter(variable %in% c("population_total", "gdp_total_mer", "primary_energy_total",
                         "emissions_co2_fossil_fuels_and_industry")) %>%
  select(scenario, region, variable, year, value) %>%
  mutate(variable = str_replace_all(variable, c("_.*$" = "", "^population" = "P",
                                                "^gdp" = "G", "^primary" = "E",
                                                "^emissions" = "F")),
         scenario = str_replace_all(scenario, "(GCAM|RCP)([0-9]|Reference)", "\\1 \\2")) %>%
  group_by(scenario, variable, year) %>% summarize(value = sum(value)) %>% ungroup()
```
```{r rcp_rates}
rates <- gcam_scenarios %>% spread(key = variable, value = value) %>%
  mutate(e = E / G, f = F / E) %>% select(year, scenario, e, f) %>%
  filter(year >= 2005, year <= 2020) %>% gather(key = variable, value = value, e, f) %>%
  nest(-scenario, -variable) %>% group_by(scenario, variable) %>%
  mutate(fit = map(data, ~lm(log(value) ~ year, data = .x))) %>%
  mutate(coefs = map(fit, coef)) %>% mutate(rate = map_dbl(coefs, 2)) %>%
  ungroup() %>%
  select(scenario, variable, rate) %>% mutate(variable = str_c("r.", variable)) %>%
  spread(key = variable, value = rate)

hist_rates <- get_kaya_data("World") %>% select(year, e, f) %>% 
  filter(year >= 2005) %>%
  gather(key = variable, value = value, -year) %>%
  nest(-variable) %>% group_by(variable) %>%
  mutate(fit = map(data, ~lm(log(value) ~ year, data = .x))) %>%
  mutate(coefs = map(fit, coef)) %>% mutate(rate = map_dbl(coefs, 2)) %>%
  ungroup() %>%
  select(variable, rate) %>% mutate(variable = str_c("r.", variable)) %>%
  spread(key = variable, value = rate) %>% mutate(scenario = "Historical")

rates <- rates %>% bind_rows(hist_rates) %>%
  mutate(scenario = str_replace(scenario, "GCAM Reference", "Baseline")) %>%
  mutate(scenario = str_replace(scenario, "GCAM", "RCP"))
```
```{r plot_rcp, fig.width = 9}
rcp_scales <- tribble(
  ~scenario,    ~order, ~break_order, ~shape, ~size,   ~nx,  ~ny,
  "Historical",      3,            1,     18,     5,   0.05,  0.02,
  "Baseline",        1,            2,     16,     3,   0.01,  0.01,
  "RCP 8.5",         2,            3,     16,     3,   0.00,  0.01,
  "RCP 6.0",         4,            4,     16,     3,   0.01, -0.01,
  "RCP 4.5",         5,            5,     16,     3,  -0.01,  0.01,
  "RCP 2.6",         6,            6,     16,     3,   0.00,  0.01
  ) %>% arrange(order) %>% mutate(scenario = ordered(scenario, levels = scenario))


rcp_levels <- levels(rcp_scales$scenario)
rcp_breaks <- rcp_scales %>% arrange(break_order) %>% select(scenario) %>% simplify() %>% unname()
rcp_shapes <- rcp_scales %>% arrange(order) %>% select(scenario, shape) %>%
  spread(key = scenario, value = shape) %>% simplify()
rcp_sizes  <- rcp_scales %>% arrange(order) %>% select(scenario, size) %>%
  spread(key = scenario, value = size) %>% simplify()

r <- rates %>%
  mutate(scenario = ordered(scenario, levels = rcp_levels)) %>%
  left_join(rcp_scales %>% select(scenario, nx, ny), by = "scenario")

r_hist <- r %>% filter(scenario == "Historical") %>%
  bind_rows(., .)

rate_plot <-  ggplot(r, aes(x = 100 * r.f, y = 100 * r.e, color = scenario,
                            shape = scenario, size = scenario)) +
  geom_hline(size = 1, color = "gray70", yintercept = 0.0) +
  geom_vline(size = 1, color = "gray70", xintercept = 0.0) +
  geom_point() +
  geom_abline(mapping = aes(intercept = 100 * (r.e + r.f), 
                            color = scenario, slope = -1),
              data = r_hist,
              size = 1) +
  geom_text_repel(aes(label = scenario),
                  force = 2.0,
                  color = "black", size = 4,
                  box.padding = 0.4,
                  nudge_x = r$nx, 
                  nudge_y = r$ny
                  ) +
  labs(y = expression(paste(Delta, " Energy Intensity of GDP (%/year)")),
       x = expression(paste(Delta, "Carbon Intensity of Energy (%/year)")))  +
  scale_x_continuous(expand = c(0, 0.125)) +
  scale_color_brewer(palette = "Dark2", direction = -1,
                     name = "Scenario", guide = "none") +
  scale_shape_manual(values = rcp_shapes, breaks = rcp_breaks, name = "Scenario",
                     guide = "none") +
  scale_size_manual(values = rcp_sizes, breaks = rcp_breaks, name = "Scenario",
                    guide = "none") +
  coord_fixed(ratio = 1) +
  theme_bw(base_size = 15)

rate_plot
```

:::
::: {.column .seventy style="width:45%;vertical-align:top;margin-top:1.0em;padding-left:0.5em;"}
* Comparing actual trends for 2005--2017 to trends for 2005--2020 in 5
  emissions scenarios:
  * {+} Points above & right of the magenta line have higher emission trends 
    than historical
  * {+} Points below & left of the magenta line have lower emission trends than 
    historical
* {+} The historical trend from 2005--2017 is doing better (lower emissions) 
  than several scenarios including baseline (no policies) and RCP 6.0
  (business as usual with current policies).
:::
::::::

## Summary

* Pielke and others were very pessimistic around 2010
* Ten years later:
  * Some reasons for greater optimism
  * But still cause for concern
  
## 2021 UN Report {.seventyfive}

![Washington Post Headline: United Nations: Countries' pledges to cut emissions are far too meager to halt climate change](assets/images/wapo-un-emissions-report.png){style="height:400px;"}

::: {.fragment .bare}
> “Current levels of climate ambition are very far from putting us on a pathway 
> that will meet our Paris agreement goals,” said Patricia Espinosa, executive 
> secretary of the U.N. Framework Convention on Climate Change. 

:::
::: {.fragment .bare .mtop-2}
> Even if countries follow through, [they] would put the world on a path to 
> achieve only a 1 percent reduction in global emissions by 2030....
> 
> By contrast, scientists have said that emissions must fall by nearly 
> 50 percent this decade for the world to realistically have a shot at avoiding 
> devastating temperature rise.

:::


## Do we have the technology? {.center}

:::::: {.bare .mtop-3}
![](assets/images/Hoffert_Wedges.jpg){style="height:900px;"}

::: {.credit}
M.I. Hoffert, _Science_ **329**, 1292 (2010)
[doi: 10.1126/science.1195449](https://doi.org/10.1126/science.1195449)
:::
::::::

# Decarbonizing Global Economy  {#decarbonizing-sec .center data-transition="fade"  data-transition="fade-out" data-state="skip_slide"}

## Decarbonizing Global Economy  {#decarbonizing .center data-transition="fade"  data_transition="fade-in"}

* World needs lots more energy
  * National/industrial energy poverty:
    * Energy consumption for economic growth
  * Household energy poverty:
    * Energy consumption for quality of life

## Energy {#energy-poverty-night-lights data-transition="fade-out"}

::::::{.bare .mtop-3}
![World lights at night](assets/images/world_night_lights.jpg){style="margin-top:66px;width:1668px;height:780px;"}

:::{.credit}
Image credit: [NASA](https://www.nasa.gov/topics/earth/earthday/gall_earth_night.html)
:::
::::::

## Population Density {#energy-poverty-pop-density data-transition="fade-in"}

::::::{.bare .mtop-3}
![World population density](assets/images/world-population-density-map.jpg){style="height:900px;"}

:::{.credit}
Image credit: [NASA](https://neo.sci.gsfc.nasa.gov/view.php?datasetId=SEDAC_POP)
:::
::::::

## Energy Poverty {#energy-poverty-studying}

:::::: {.bare .mtop-3}
![Youths studying at G'Bessi Airport, Guinea](assets/images/studying_gbessi_airport.jpg){style="height:900px;"}

:::{.credit}
Photo: Rebecca Blackwell, Associated Press, June 2007.
:::
::::::

::: notes

Students at the Conakry airport parking lot in Guinea, studying.
The dim lights at the airport parking lot are the best they can get
in the energy-poor capital.

Photo: Rebecca Blackwell, Associated Press, June 2007.

:::

## Household Energy Poverty {#energy-poverty-stats .ninety}

* {+} Roughly 1.2 billion people do not have acccess to electricity.
  * Down from 1.5 billion in 2008
* {+} Benefits of providing even a little electricity:
  * Children study 30% more with just one light bulb in home.
  * Women have more say in household decisions
  * Allows economically productive activity in evening
* {+} Role of refrigeration in preventing disease
* {+} Electricity and gas reduce exposure to indoor air pollution
  * {+} Indoor air pollution from cooking, lighting kills around 4.3 million/year
* {+} Home solar typically provides light, but insufficient for refrigeration, cooking

# Measuring Energy<br/>and Environmental Impact {#definition-sec .center}

## Measuring Energy {#measuring-energy .eightyfive}
```{r world_energy, include=FALSE, echo=FALSE}
world_now <- get_kaya_data("World") %>% top_n(1, wt = year)
us_now <- get_kaya_data("United States") %>% top_n(1, wt = year)
```

* Heat:
  * BTU (British Thermal Unit) = quantity of heat
  * Quad = quadrillion BTU
  * Kilowatt Hour (kWh): measure of electricity
* {+} Conversions:
  * 1 quad is about 300 billion kWh
  * 1 quad per year is about 11 billion watts
    * Typical large power plant (coal or nuclear) produces an average of 
      around 750 million watts
    * 1 quad per year is about 15 big power plants
* {+} Magnitudes
  * World uses about 
    `r scales::label_number(accuracy = 10)(world_now$E)`
    quads per year of primary energy
  * U.S. uses about 
    `r scales::label_number(accuracy = 10)(us_now$E)`
    quads per year of primary energy
    * `r scales::label_percent(accuracy = 1)(us_now$P / world_now$P)` 
      of population, 
      `r scales::label_percent(accuracy = 1)(us_now$E / world_now$E)` 
      of energy consumption

## Some Definitions: {#energy-definitions .eightyfive}

* Primary vs. Secondary
  * Primary energy consumption = heat generated
  * Secondary energy consumption = useful energy consumed
    * Coal generation is about 33% efficient
    * Gas generation is about 45% efficient
    * A car engine is about 33% efficient
  * More efficient generation can produce more secondary energy with
    less primary energy.
* {+} Nameplate vs. Average Power Output:
    * Nameplate = power when operating at 100% capacity
    * Capacity factor = average fraction of maximum capacity achieved over a year
    * Actual energy produced = nameplate power &times; capacity factor &times; 1 year

# Kaya Identity {#kaya-sec .center}

## Kaya Identity {#kaya-identity .eightyfive}

:::::: {.bare .mtop-3}
$$\color{firebrick}{F} = \color{darkgreen}{P} \times \color{blue}{g}\times 
  \color{mediumorchid}{e} \times \color{crimson}{f}$$

* $\color{firebrick}{F} =$ emissions (million tonnes carbon per year)
* $\color{darkgreen}{P} =$ population (billions)
* $\color{blue}{g} =$ per-capita GDP ($1000 per person)
* $\color{mediumorchid}{e} =$ energy intensity of economy (quads / trillion dollars)
* $\color{crimson}{f} =$ carbon intensity of energy supply (million tonnes carbon / quad)

::: {.mtop-3}
### Policy 

* {+} We can't directly control $\color{darkgreen}{P}$
* {+} We want $\color{blue}{g}$ to grow
* {+} Therefore, decrease $\color{mediumorchid}{e}$ and $\color{crimson}{f}$

:::
::::::

# Economic and Energy Trends {#energy-econ-trend-sec .center }

## Interactive Tool {#interactive-tool}

<https://ees3310.jgilligan.org/decarbonization/>

Kaya data and analysis for your own computer: 

<https://jonathan-g.github.io.kayadata>
```r
install.packages("kayadata")
```

An experimental version of the interactive tool is available at
<https://github.com/jonathan-g/kayatool>.

You can install it on your own computer, 
<br/>but it may be a bit iffy
when you run it.

## Global Population (_P_ ) {#global_population .eighty}
```{r maddison, cache=TRUE, include=FALSE}
new_world <- get_kaya_data("World") %>%
  select(year, P, G, g, E, e, F) %>%
  arrange(year)

ow_names <- read_csv(file.path(data_dir, "ghg_emissions", "cdiac",
                               "global.1751_2014.csv"),
                     col_names = FALSE, n_max = 1) %>%
  unlist() %>% unname() %>% make_clean_names()

F_name = ow_names %>% keep(~str_starts(.x, "total_"))
efg_name = ow_names %>% keep(~str_starts(.x, "per_capita"))

old_world_f <- read_csv(file.path(data_dir, "ghg_emissions", "cdiac",
                                  "global.1751_2014.csv"),
                        col_names = ow_names, skip = 2) %>%
  select(year, F = !!F_name, efg = !!efg_name) %>%
  mutate_at(vars(F, efg), ~. * 44 / 12)

maddison_regions <- read_excel(file.path(data_dir, "ghg_emissions", "mpd2018_region_data.xlsx"),
                    sheet = "Long data")

old_world_p <- maddison_regions %>%
  filter(region_name == "World") %>%
  transmute(year, g = cgdppc * 1E-3, P = pop * 1E-6, G = g * P)

old_world <- old_world_f %>% left_join(old_world_p, by = "year") %>%
  mutate(efg = ifelse(is.na(efg), F / P, efg)) %>%
  filter(! is.na(P))

combine_kaya <- function(kaya_old, kaya_new) {
  kaya <- full_join(kaya_old, kaya_new, by = "year", 
                           suffix = c(".old", ".new")) %>%
  mutate(P.ratio = P.new / P.old, G.ratio = G.new / G.old, 
         g.ratio = g.new / g.old, F.ratio = F.new / F.old) %>%
  mutate_at(vars(contains(".ratio")), ~mean(., na.rm = T)) %>%
  mutate(P.old = P.old * P.ratio, G.old = G.old * G.ratio, 
         g.old = g.old * g.ratio, F.old = F.old * F.ratio) %>%
  transmute(year, P = ifelse(is.na(P.new), P.old, P.new),
            G = ifelse(is.na(G.new), G.old, G.new),
            g = ifelse(is.na(g.new), g.old, g.new),
            F = ifelse(is.na(F.new), F.old, F.new) * 1E-3
            )
  invisible(kaya)
}

world <- combine_kaya(old_world, new_world)

model <- lm(log(F)~year, world)
fitted <- model %>% augment() %>% mutate(fit = exp(.fitted)) %>%
  select(year, fit)
world <- world %>% left_join(fitted, by = "year")
trend_string <- model %>% tidy() %>% filter(term == 'year') %>% 
  select(estimate) %>% mutate(estimate = round(estimate * 100, 1)) %>%
  unlist() %>%
  paste0('Trend (', ., '% per year)')
max.year <- world %>% select(year, F) %>% na.omit() %$% year %>% max()
min.year <- world %>% select(year, F) %>% na.omit() %$% year %>% min()
this.year = year(now())
```
```{r world_pop, echo=FALSE, warning = FALSE}
scott_manning_pop_file <- "Appendix_ World Population Estimate Sets.xlsx"
pop <- read_excel(file.path(data_dir, "ghg_emissions", scott_manning_pop_file),
                  skip = 2, n_max = 115 - 2) %>% 
  clean_names() %>% select(-starts_with("x")) %>%
  mutate(P = rowMeans(.[,-1], na.rm = T) * 1E-9,
         n = year %>% str_replace_all("[^0-9]", "") %>% as.integer(),
         s = ifelse(str_detect(year, fixed("B.C.")), -1, 1),
         y = n * s) %>%
  select(year = y, P)

p_kaya <- get_kaya_data("World") %>% select(year, P) %>%
  full_join(pop, by = "year", suffix = c("", ".sm")) %>%
  transmute(year, P = ifelse(is.na(P), P.sm, P)) %>%
  arrange(year)


p <- ggplot(p_kaya, aes(x = year, y = P)) + 
  geom_line(size = 1, color = "dark blue") +
  labs(x = "Year", y = "Population (billions)")
  
p + xlim(1800,NA)
```

## Global Economy (per-capita GDP _g_) {#global-economy}
```{r world_gdp_per_capita, echo=FALSE, warning=FALSE}
# g_maddison <- maddison %>% filter(nation == "World", year <= 2000) %>%
#   select(year, g) %>% mutate(g = g / 1000)
# 
# g_kaya <- get_kaya_data("World") %>% select(year, g) %>%
#   full_join(g_maddison, by = "year", suffix = c("", ".m"))
# 
# g_scale = g_kaya %>% filter(!is.na(g), !is.na(g.m), year <= 2000) %>%
#   summarize(scale = exp(mean(log(g) - log(g.m)))) %$% scale
# 
# g_kaya_2 <- g_kaya %>% transmute(year, g = ifelse(is.na(g), g.m * g_scale, g))
# 
p <- ggplot(world, aes(x = year, y = g)) + 
  geom_line(color = "dark blue", size = 1) +
  labs(x = "Year", y = "Per-capita GDP (thousand 2018 dollars)")

p + xlim(1800,NA)
```

## Global Income Distribution {#global-income-distribution}

::::::{.bare .mtop-3}
![](assets/images/dikhanov_income.png){style="height:800px;"}

:::{.credit}
Image credit: 
Y. Dikhanov & M. Ward, 
"Evolution of the Global Distribution of Income in 1970--99" (2001).
:::
::::::
::::::{.ninety}
* Big drop in "desperate poverty"
* Growth of global middle-class
::::::

## Global Income Distribution {#global-income-distribution-change}


::::::{.bare .mtop-3}
![](assets/images/milanovic_income_change.png){style="height:800px;"}

:::{.credit}
Image credit: 
B. Milanovic, _Global Inequality_ (Harvard, 2016).
:::
::::::
::::::{.eighty}
* Rightward movement of lower end: Big drop in poverty
* Growing lump in middle: Rise of global middle-class
::::::

## Global Income Growth over Time {#global-income-growth-2}

::::::{.bare .mtop-1}
![](assets/images/milanovic_income_growth.png){style="height:800px;"}

:::{.credit}
Image credit: 
B. Milanovic, _Global Inequality_ (Harvard, 2016).
:::
::::::
::::::{.seventy}
* Biggest gains for 10^th^--65^th^ percentile (poor and middle class)
* Losses for 80^th^--85^th^ percentile (middle class of rich nations)
* Big gains for richest 5% (> $75,000 US)
::::::

## Emissions Intensity of Global Economy (_ef_ )
```{r world_emissions_intensity, echo=FALSE, warning=FALSE}
world_kaya <- get_kaya_data("World")
plot_kaya(world_kaya, "ef")
```

## Energy Intensity of Global Economy (_e_)
```{r world_energy_intensity, echo=FALSE, warning=FALSE}
plot_kaya(world_kaya, 'e')
```

## Carbon Intensity of Global Energy Supply (_f_ )
```{r world_carbon_intensity, echo=FALSE}
plot_kaya(world_kaya, "f")
```

# Implied Decarbonization  {#implied-sec .center}

## Implied Decarbonization  {#implied-1 data-transition="fade-out"}

* Specify emissions for 2050, compared to 2010
* Assume global GDP ${\color{darkcyan}G}$ grows at rate $r$<br/>(5% &rarr; $r = 0.05$)

:::{.eighty .mtop-3}
\[\begin{aligned}
\text{emissions: } {\color{firebrick}F} &= {\color{darkgreen}P} {\color{blue}g} {\color{mediumorchid}e} {\color{crimson}f} = {\color{darkcyan}G} \times {\color{mediumorchid}e}{\color{crimson}f} \\
{\color{firebrick}F}(2050) &= {\color{darkcyan}G}(2050) \times {\color{mediumorchid}e}{\color{crimson}f}(2050)
\end{aligned}
\]
:::

:::{.fragment .eighty .mtop-3}
### Growth:

\[\begin{aligned}
y(\text{5 years from now}) &= y(\text{today}) \times \exp(r \times 5) \\
&\approx y(\text{today}) \times (1 + r)^5
\end{aligned}
\]

* {+} exp = exponential function ($e^x$).
* {+} Call it "exp"  to avoid confusing $\color{mediumorchid}e$ in Kaya formula 
  <br/>with $e$, base of natural logarithm.
:::

## Implied Decarbonization  {#implied-2 data-transition="fade-in"}

* Specify emissions for 2050, compared to 2010
* Assume global GDP ${\color{darkcyan}G}$ grows at rate $r$
  <br/>(5% &rarr; $r = 0.05$)

:::{.mtop-3 .eighty}
\[\begin{aligned}
\text{emissions: } {\color{firebrick}F} &= {\color{darkgreen}P} {\color{blue}g} {\color{mediumorchid}e} {\color{crimson}f} = {\color{darkcyan}G} \times {\color{mediumorchid}e}{\color{crimson}f} \\
{\color{firebrick}F}(2050) &= {\color{darkcyan}G}(2050) \times {\color{mediumorchid}e}{\color{crimson}f}(2050) \\[1ex]
{\color{darkcyan}G}(2050) &= {\color{darkcyan}G}(2010) \times \exp(r \times (2050-2010)) \\[1ex]
{\color{mediumorchid}e}{\color{crimson}f}(2050) &= \frac{{\color{firebrick}F}(2050)}{{\color{darkcyan}G}(2050)}\\
  &= \frac{{\color{firebrick}F}(2050)}{{\color{darkcyan}G}(2010) \times \exp(r \times 40)}
  \approx \frac{{\color{firebrick}F}(2050)}{{\color{darkcyan}G}(2010) \times (1 + r)^{40}}
\end{aligned}
\]
:::

## Reduce emissions 50% by 2050: {#implied-3 data-transition="fade"}
```{r implied_1, echo=FALSE}
kw <- get_kaya_data("World")
reduction <- 0.50
t1 <- 2050
t0 <- 2010
tdelta <- t1 - t0
n_year <- t1-t0
G0 <-507.096E+3 / 9932 #trillion
ef0 <- kw$ef[kw$year == t0]
F0 <- G0 * ef0
rF <- 1 - exp(log(reduction)/n_year)
growth <- seq(0.01,0.05,0.01)
ff <- data.frame()
years <- seq(t0,t1)
for(g in growth) {
  ff <- rbind(ff, data.frame(year=years, growth = g, 
                             ef = ef0 * (1 - (rF+g))^(years - t0)))
  }
ff$growth <- factor(ff$growth)

p <- ggplot(ff,aes(x=year,y=ef,color=growth,shape=growth)) + 
  # geom_point(size=I(point_size)) + 
  geom_point(size = 1) + 
  geom_line(size=1.5) +
  labs(x="Year",y=expression(paste("million tonnes ", CO[2] / "$trillion"))) +
  scale_shape(labels=paste0(100*growth,'%'), name="Economic growth") +
  scale_color_brewer(type='qual',palette='Dark2',
                     labels=paste0(100*growth,'%'), name="Economic growth") +
  scale_x_continuous(expand=c(0,0), limits=c(t0,t1 + 0.05 * tdelta)) +
  theme_bw(base_size=20) + 
  theme(legend.position=c(0.95,1), legend.justification=c(1,1), 
        legend.title.align=0.5,
        legend.key.size=unit(0.02,'npc'), 
        legend.key.width=unit(0.05,'npc'),
        legend.key.height=unit(0.04,'npc'))
print(p)

```

## Actual and Implied Decarbonization  {#implied-4 data-transition="fade"}
```{r implied_2, echo=FALSE}

f2 <- get_kaya_data("World", ) %>% filter(year >= 1980 & year <= t0) %>% 
  select(year, ef)
f2$growth <- 'historical'

f2 <- rbind(f2,ff)

f2$growth <- factor(f2$growth, levels=c('historical',growth), ordered=T)
p <- ggplot(f2,aes(x=year,y=ef,color=growth,shape=growth)) + 
#  geom_point(size=I(point_size)) + 
  geom_line(size=1.5) +
  labs(x="Year",y= expression(paste("MMT ", CO[2] / "$trillion"))) +
  scale_shape_manual(breaks=c('historical',growth), 
                     values=c(NA,16,17,18,4,3),
    labels=c('Historical',paste0(100*growth,'%')), name="Economic Growth") +
  scale_color_brewer(type='qual',palette='Dark2',
                     breaks=c('historical',growth), 
                     labels=c('Historical',paste0(100*growth,'%')), 
                     name="Economic Growth") +
  theme_bw(base_size=20) + 
  theme(legend.position=c(1,1), legend.justification=c(1,1), 
        legend.title.align=0.5,
        legend.key.size=unit(0.02,'npc'), 
        legend.key.width=unit(0.05,'npc'), 
        legend.key.height=unit(0.04,'npc'))
print(p)

```

## Pielke's Policy Criteria {.center}

1. Policies should flow with public opinion
1. Public will not tolerate significant short-term costs, 
   even for big long-term benefits
1. Policy must center on clean energy innovation
