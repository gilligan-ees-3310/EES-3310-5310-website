---
title: "Computer Models"
class_no: 16
class_date: "Monday, March 1"
qrimage: qrcode.png
pageurl: "ees3310.jgilligan.org/slides/class_16"
pdfurl: "ees3310.jgilligan.org/slides/class_16/ees_3310_5310_class_16_slides.pdf"
course: "EES 3310/5310"
course_name: "Global Climate Change"
author: "Jonathan Gilligan"
semester: Spring
year: 2021
output:
  revealjg::revealjs_presentation
---
```{r setup, cache = F, echo = F, eval = T, message=F, warning=F}
knitr::opts_chunk$set(cache=TRUE, 
                      echo=FALSE, message=FALSE, warning=FALSE,
                      fig.height=9, fig.width=14, dpi=100,
                      dev='png',fig.path='assets/fig/',cache.path='./cache/')

library(rprojroot)

semester_dir <- find_rstudio_root_file()
data_dir <- file.path(semester_dir, "data")
script_dir <- file.path(semester_dir, "lecture_scripts")

source_semester_script <- function(script) {
  script_file <- file.path(script_dir, script)
  message("Running script", script_file)
  source(script_file, chdir = T)
}

eval_in_sem_script_dir <- function(expr, loc = script_dir) {
  this_dir <- getwd()
  setwd(loc)
  retval <- eval(expr)
  setwd(this_dir)
  invisible(retval)
}

library(magrittr)
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(broom)
library(kayadata)

source_semester_script('lecture_utils.R')
```
# Climate and Economy  {#climate-econ-sec .center}

## Climate and Economy  {#climate-econ-1 .ninety}

::: {.textcenter .mbot-2}
**How well do markets manage global warming?**
:::

* {+} How well do markets manage supply and price of bread?
* {+} What is different about global warming?
* {+} Externalities:
  * {+} What is an externality?
  * {+} Are externalities good or bad?
  * {+} What challenges to they pose for markets?
  * {+} How can market-based economies manage externalities better?

::: {.textcenter .fragment .mtop-3}
**Discuss for 5 minutes in breakout rooms**
:::

## Energy, Economy, Emissions  {#ege-1 data-transition="fade"}

```{r global_emissions, cache=TRUE, fig.width = 16}
new_world <- get_kaya_data("World") %>%
  select(year, P, G, g, E, e, F) %>%
  arrange(year)

# budget_file <- file.path(data_dir, "carbon_cycle", "carbon_budgets",
                         # "Global_Carbon_Budget_2020v0.83.xlsx")
# ow_names <- read_excel(budget_file, sheet = "Historical Budget",
#                      col_names = FALSE, skip = 14, n_max = 1) %>%
#   unlist() %>% unname() %>% make_clean_names()

budget_file <- file.path(data_dir, "carbon_cycle", "carbon_budgets",
                         "global.1751_2017.csv")
ow_names <- read_csv(budget_file, col_names = FALSE, skip = 4, n_max = 1) %>%
  unlist() %>% unname() %>% make_clean_names()

F_name = ow_names %>% keep(~str_starts(.x, "total_"))
efg_name = ow_names %>% keep(~str_starts(.x, "per_capita"))

# old_world_f <- read_excel(budget_file, sheet = "Historical Budget", 
#                           skip = 15, col_names = ow_names) %>%
#   select(year, F = {{ F_name }}, efg = {{ efg_name }}) %>%
#   mutate_at(vars(F, efg), ~. * 44 / 12)
# 

old_world_f <- read_csv(budget_file, skip = 5, col_names = ow_names) %>%
  select(year, F = {{ F_name }}, efg = {{ efg_name }}) %>%
  mutate_at(vars(F, efg), ~. * 44 / 12)


maddison_file <- file.path(data_dir, "carbon_cycle",  "carbon_budgets", 
                           "mpd2020.xlsx")
mr_names <- read_excel(maddison_file, sheet = "Regional data", 
                       col_names = FALSE, skip = 1, n_max = 1) %>%
  unlist() %>% unname() %>% make_clean_names()

mr_names <- case_when(
    mr_names == "region" ~ "year",
    str_detect(mr_names, "_2$") ~ str_replace(mr_names, "_2$", "_pop"),
    mr_names == "world" ~ "world_pop",
    ! str_detect(mr_names, "world") ~ str_c(mr_names, "_gdp_pc"),
    TRUE ~ mr_names
  )

maddison_regions <- read_excel(maddison_file, sheet = "Regional data",
                               skip = 3, col_names = mr_names) %>%
  pivot_longer(cols = -year, names_to = "region", values_to = "value") %>%
  mutate(variable = ifelse(str_detect(region, "_pop"), "P", "g"),
         region = str_remove(region, "_(pop|gdp_pc)$") %>% 
           str_replace_all("_+", " ") %>% str_to_title() %>%
           str_replace_all("\\bAnd\\b", "and") %>%
           str_replace_all("^Asia (.*)$", "\\1 Asia")) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(g = g / 1000, P = P / 1E6, G = g * P)

old_world_p <- maddison_regions %>% filter(region == "World")

old_world <- old_world_f %>% left_join(old_world_p, by = "year") %>%
  mutate(efg = ifelse(is.na(efg), F / P, efg))

combine_kaya <- function(kaya_old, kaya_new) {
  kaya <- full_join(kaya_old, kaya_new, by = "year", 
                           suffix = c(".old", ".new")) %>%
  mutate(P.ratio = P.new / P.old, G.ratio = G.new / G.old, 
         g.ratio = g.new / g.old, F.ratio = F.new / F.old) %>%
  mutate_at(vars(contains(".ratio")), ~mean(., na.rm = T)) %>%
  mutate(P.old = P.old * P.ratio, G.old = G.old * G.ratio, 
         g.old = g.old * g.ratio, F.old = F.old * F.ratio) %>%
  transmute(year, P = ifelse(is.na(P.new), P.old, P.new),
            G = ifelse(is.na(G.new), G.old, G.new),
            g = ifelse(is.na(g.new), g.old, g.new),
            F = ifelse(is.na(F.new), F.old, F.new) * 1E-3
            )
  invisible(kaya)
}

world <- combine_kaya(old_world, new_world)

F_world <- world %>% filter(! is.na(F))

model <- lm(log(F)~year, F_world)
fitted <- model %>% augment() %>% mutate(fit = exp(.fitted)) %>%
  select(year, fit)
F_world <- F_world %>% left_join(fitted, by = "year")
trend_string <- model %>% tidy() %>% filter(term == 'year') %>% 
  select(estimate) %>% mutate(estimate = round(estimate * 100, 1)) %>%
  unlist() %>%
  paste0('Trend (', ., '% per year)')
max.year <- F_world %>% select(year, F) %>% na.omit() %$% year %>% max()
min.year <- F_world %>% select(year, F) %>% na.omit() %$% year %>% min()
this.year = year(now())


p <- ggplot(F_world, aes(x=year,y=F)) + 
  geom_line(aes(color='data'), size=I(1)) + 
  geom_point(aes(color='data',shape='data'), size=I(3))
p <- p + 
  # scale_y_log10(breaks=c(0.01, 0.02, 0.03, 0.06, 0.1, 0.2, 0.3, 0.6, 
  #                        1, 2, 3, 6, 10, 20, 30, 60, 100)) + 
  scale_y_log10(limits = c(NA, 100)) +
  scale_x_continuous(breaks=seq(1700,this.year,20)) +
  labs(y=expression(paste("Emissions ( GT ", CO[2] / year, ")")),
       x = "Year", 
       title=substitute(paste("Global ", CO[2], " emissions ", x0, "-", x1), 
                        list(x0 = min.year, x1 = max.year)))
p <- p + 
  geom_line(data = bind_rows(head(fitted,1), tail(fitted,1)),
            aes(color='fit', y=fit), size=I(1.5)) +
  geom_point(data = bind_rows(head(fitted,1), tail(fitted,1)),
            aes(color='fit', shape='fit', y=fit)) 
p <- p + 
  scale_color_manual(values=c('data'='black','fit'='purple'),
                     name="",
                     labels=c(expression(paste(CO[2], ' emissions')),
                              trend_string)) +
  scale_shape_manual(values=c('data'=16,'fit'=32),
                     name="",
                     labels=c(expression(paste(CO[2], ' emissions')),
                              trend_string))
p <- p + 
  theme_bw(base_size=30) + 
  theme(legend.key.width=unit(0.05,'npc'),
        legend.key.height=unit(2.7,'lines'),
        panel.grid.minor.x = element_line(color="gray85",size=0.5),
        panel.grid.major = element_line(color="gray85",size=0.5),
        legend.background = element_rect(color='black',size=0.5),
        legend.position=c(0.99,0.01), 
        legend.justification=c(1,0),
        legend.text = element_text(size=35),
        legend.title = element_blank())

print(p)

```

## Energy, Economy, Emissions  {#ege-2 data-transition="fade"}
```{r us_carbon_intensity, cache=TRUE, fig.width = 16, dependson='global_emissions'}
maddison_countries <- read_excel(maddison_file, sheet = "Full data")

interp <- function(x, y, xout) {
  df <- tibble(x = x, y = y) %>% na.omit()
  if (nrow(df) == 0) {
    rep(NA, length(xout))
  } else {
    approx(df, xout = xout, method = "linear")$y
  }
}

old_usa_p <- maddison_countries %>%
  filter(countrycode == "USA") %>%
  select(year, gdppc, pop) %>%
  right_join(tibble(year = seq(1700, this.year)), by = "year") %>%
  mutate(pop = interp(year, pop, year),
         cgdppc = interp(year, gdppc, year)) %>%
  transmute(year, g = gdppc * 1E-3, P = pop * 1E-6, G = g * P)

nat_file <- file.path(data_dir, "carbon_cycle", "carbon_budgets", 
                      "nation.1751_2017.csv")

old_nat_names <- read_csv(nat_file, col_names = FALSE, skip = 4, 
                          n_max = 1) %>% 
  unlist() %>% unname() %>% make_clean_names()

total_name <- old_nat_names %>% keep(~str_starts(.x, "total_co2"))
per_capita_name <- old_nat_names %>% keep(~str_starts(.x, "per_capita"))

old_nat_f <- read_csv(nat_file, col_names = old_nat_names, skip = 5,
                      na = c("", ".", "NA")) %>%
  select(nation, year, F = {{ total_name }}, efg = {{ per_capita_name }}) %>%
  mutate(F = F * 1E-6)
  
old_usa_f <- old_nat_f %>% filter(nation == "UNITED STATES OF AMERICA") %>%
  select(year, F, efg)

old_usa <- left_join(old_usa_f, old_usa_p, by = "year") %>%
  mutate(efg = ifelse(is.na(efg), F / P, efg))

new_usa <- get_kaya_data(region_code = "USA") %>%
  select(year, P, G, g, F) %>%
  arrange(year)

usa <- combine_kaya(old_usa, new_usa) %>%
  mutate(ef = F / G, efg = F / P)

max.year <- usa %>% select(year, ef) %>% na.omit() %$% year %>% max()


model <- lm(log(ef) ~ year, data=usa %>% filter( year >= 1930))

fitted <- model %>% augment %>% mutate(fit = exp(.fitted)) %>% 
  select(year, fit)
usa <- usa %>% full_join(fitted, by = "year")

# trend_string <- model %>% tidy() %>% filter(term == 'year') %>% 
#   select(estimate) %>% 
#   mutate(estimate = round(estimate * 100 / tail(usa$intensity,1), 1)) %>%
#   unlist() %>%
#   paste0('Trend (', ., '% per year)')

trend_string <- model %>% tidy() %>% filter(term == 'year') %>% 
  select(estimate) %>% mutate(estimate = round(estimate * 100, 1)) %>%
  unlist() %>%
  paste0('Trend (', ., '% per year)')


usa_ef <- usa %>% filter(! is.na(ef))

min.year = usa_ef %>% select(year, ef) %>% na.omit() %$% year %>% min()
max.year = usa_ef %>% select(year, ef) %>% na.omit() %$% year %>% max()

p <- ggplot(usa_ef,aes(x=year,y=ef)) + 
  geom_line(aes(color='data'), size=1, na.rm = T) + 
  geom_point(aes(color='data',shape='data'), size=3, na.rm = T) + 
  scale_y_log10(breaks = c(0.01, 0.02, 0.03, 0.05, 
                           0.1, 0.2, 0.3, 0.5, 
                           1, 2, 3, 5), limits=c(NA,3.5)) + 
  scale_x_continuous(breaks=seq(1700,this.year,25)) +
  labs(y=expression(paste(CO[2], " intensity ( tons ", CO[2] , " / $1000 GDP)")),
       x = "Year", 
       title=substitute(paste(CO[2], " intensity of the US economy ", x0, "-", x1), 
                        list(x0 = min.year, x1 = max.year))) +
  geom_line(aes(color='fit', y=fit), size=I(1.5),
            data = bind_rows(head(fitted, 1), tail(fitted, 1))) + 
  geom_point(aes(color='fit', shape='fit',y=fit),
             data = bind_rows(head(fitted, 1), tail(fitted, 1))) + 
  scale_color_manual(values=c('data'='black','fit'='purple'),
                     name=NULL,
                     labels=c(expression(paste(CO[2], ' intensity')),
                              trend_string)) +
  scale_shape_manual(values=c('data'=16,'fit'=NA),
                     name=NULL,
                     labels=c(expression(paste(CO[2], ' intensity')),
                              trend_string)) +
  theme_bw(base_size=30) + 
  theme(legend.key.width=unit(0.05,'npc'),
        legend.key.height=unit(0.5,'lines'),
        panel.grid.minor.x = element_line(color="gray85",size=0.5),
        panel.grid.major = element_line(color="gray85",size=0.5),
        legend.background = element_rect(color='black',size=0.5),
        legend.position=c(0.99,0.01), 
        legend.justification=c(1,0),
        legend.text = element_text(size=20),
        legend.title = element_blank())

print(p)

```

# Kaya Identity  {#kaya-sec .center}

## Kaya Identity  {#kaya .ninety}

$$
\color{darkgreen}{P} \times 
  \frac{\color{blue}{G}}{\color{darkgreen}{P}} \times 
  \frac{\color{purple}{E}}{\color{blue}{G}} \times 
  \frac{\color{red}{F}}{\color{purple}{E}} = \color{red}{F},
$$
<br/>

**where**

<br/>
$$
\begin{aligned}
  \color{red}{F} &= \COO~\text{emissions}\\
  \color{purple}{E} &= \text{energy use}\\
  \color{blue}{G} &= \text{gross domestic product}\\
  \color{darkgreen}{P} &= \text{population}
\end{aligned}
$$

## Kaya Identity  {#kaya-2 .ninety data-transition="fade"}

$$\begin{aligned}
  \color{red}{F} &= \color{darkgreen}{P} \times 
  \frac{\color{blue}{G}}{\color{darkgreen}{P}} \times 
  \frac{\color{purple}{E}}{\color{blue}{G}} \times 
  \frac{\color{red}{F}}{\color{purple}{E}}\\
  &= \color{darkgreen}{P} \times \color{blue}{g}\times 
  \color{purple}{e} \times \color{red}{f}\\
\end{aligned}$$
<br/>
**where**
<br/>
$$\begin{aligned}
  \color{darkgreen}{P} &= \text{population}\\
  \color{blue}{g} &= \color{blue}{G} / \color{darkgreen}{P} = \text{per-capita GDP}\\
  \color{purple}{e} &= \color{purple}{E} / \color{blue}{G} = \text{energy intensity of economy}\\
  \color{red}{f} &= \color{red}{F} / \color{purple}{E} = \COO~\text{intensity of energy supply}
\end{aligned}$$

## Kaya Identity in Practice  {#kaya-3 .ninety data-transition="fade"}

```{r world_energy_intensity, cache=TRUE}
max_year <- max(kaya_data$year)
df <- kaya_data %>% filter(year == max_year, geography == "nation") %>%
  mutate(P = P * 1E9, G = G_mer * 1E12, 
         g = G / P,
         ee = E / P * 25.200E6) %>% # tonnes of oil
  select(year, country = region, g, e, ee) %>% na.omit()

p <- ggplot(df, aes(x=g,y=ee)) +
  geom_point(aes(color=e), size=I(4)) + 
  geom_point(aes(color=e,
                 shape=country), size=I(10),
             data=df %>% filter(country %in% c('United States','China'))) +
  scale_x_log10(breaks=c(100,1000,10000,100000), 
                labels=scales::dollar_format(accuracy = 1)) +
  scale_y_log10(breaks=c(0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30)) +
  labs(y="Energy use (tons of oil eq. per capita)",
       x = "GDP per capita", title=str_c("Energy and GDP in ", max_year)) +
  scale_shape_manual(values=c('United States'=17,
                              'China'=15),
                     name="Country") +
  scale_color_gradient(name='Energy Intensity', high="red",low="blue", 
                       na.value="green") +
  theme_bw(base_size=30)

print(p)
```

# Computer Models of Climate {#climate-models-sec data-transition="fade" data-state="skip_slide"}

## Computer Models of Climate {#climate-models data-transition="fade-out"}

![](assets/images/ModelDynamics_1.jpg){style="height:900px;"}

## Computer Models  {#models-2 data-transition="fade"}

![](assets/images/model_processes.jpg){style="height:900px;"}

## Computer Models  {#models-3 data-transition="fade"}

:::::: {.columns style="display:flex;align-items:center;justify-content:center;"}
::: {.column style="width:50%;"}

![](assets/images/model_resolution.jpg){style="height:900px;"}

:::
::: {.column style="width:50%;"}

![](assets/images/ar5_resolution.jpg){style="height:900px;"}

:::
::::::

## Principles of Computer Modeling  {#models-4 .ninety}

* Make models as simple as possible:
  * Start simple
  * Add complexity only as needed
    * Different models for different purposes
  * Check model against real world

!["Things should be made as simple as possible, but no simpler." --- Albert Einstein](assets/images/einstein.jpg){.fragment .fade-in style="height:630px;"}

# Transient vs.<br/>Equilibrium Response  {#transient-response-sec .center data-transition="fade-out"}

## Transient vs. Equilibrium Response  {#transient-response .ninety data-transition="fade-in"}

::::::{.columns}
:::{.column .ptop-3}
* {+} Gradually raise \(\COO\) and then stop.
* {+} Planet takes time to heat up
  * {+} Oceans absorb heat
  * {+} Like pot of water on stove
* {+} Transient response:<br/>\(\Delta T\) when \(\COO\) stops changing
* {+} Equilibrium response:<br/>Stable temperature (much later)
  * [Green: Atmosphere & surface ocean]{style="color:darkgreen;"}
  * [Red: Atmosphere, surface ocean, & deep ocean.]{style="color:red;"}
* {+} Equilibrium takes many decades.
:::
::: {.column .bare style="width:780px;"}
![](assets/images/transient_response.png){style="width:780px;height:900px;max-height:100%;max-width:100%;"}
:::
::::::

# Modeling for<br/>Science vs. Policy  {#iams-sec .center data-transition="fade-out"}

## Modeling for Science vs. Policy  {#iams .ninety data-transition="fade-out"}

### Integrated Assessment Models (IAMS)

* {+} Combine climate system and world economy 
  * {+} Emissions as a consequence of economic activity
    * {+} Energy use for production (factories, etc.)
    * {+} Energy use for consumption (households, etc.)
    * {+} Farming: fertilizers, livestock, paddy fields, etc.
  * {+} Climatic impacts on economy
    * {+} Cost of severe weather
    * {+} Sea level rise
    * {+} Droughts & heat waves
    * {+} ...
* {+} **Optimize for greatest net economic output**
    
## Climate Projections  {#model-scenarios .eightyfive .center}

* {+} Biggest uncertainty in predicting future climates is GHG emissions
  *  {+} We can predict consequences of emissions
  *  {+} We can't predict what emissions will be
* {+} Scenarios and Pathways:
  * {+} **Scenario**: possible future, 
    *  Story of economic & political development $\rightarrow$ resulting emissions
  * {+} **Pathway**: possible future, 
    *  Trajectory of emissions $\rightarrow$ economic activity that might cause them
* {+} Projections:
  * {+} Conditional predictions: 
    * "**If** emissions do this, **then** climate will do that."

<!--- ---> {#us-projections .center data-transition="fade" }
------

### Projections for future emissions in US:

```{r scenarios, include=FALSE}
years <- c(2010,2050,2100)

scenarios <- data.frame( 
  name = c('US','world'),
  g = c(1.7,2.1),
  ef = c(-1.6,-1.6),
  p = c(0.6,0.9)
) %>% 
  mutate(F = p + g + ef) %>%
  gather(-name, key = "variable", value = "rate")

baseline <- data.frame(
  year = c(years[1],years[1]), name = c('US','world'),
  g = c(42300,9780), ef = c(432,522), p = c(309,6410)
)

future <- baseline %>% bind_rows(tibble(year = years[-1])) %>% 
  complete(year, name) %>% filter(!is.na(name)) %>% 
  gather(-year, -name, key = variable, value = value)

future <- future %>% left_join(scenarios, by = c("variable", "name")) %>%
  arrange(year) %>% 
  group_by(name, variable) %>% 
  mutate(value = ifelse(! is.na(value), value,
                        value[1] * exp(rate * 0.01 * (year - year[1])))) %>%
  ungroup() %>%
  select(-rate) %>% spread(key = variable, value = value) %>%
  mutate(F = p * g * ef * 1E-6)

alt_scenarios <- data.frame( 
  name = c('world'),
  g = c(2.3),
  ef = c(-1.4),
  p = c(1.0)
) %>% 
  mutate(F = p + g + ef) %>%
  gather(-name, key = "variable", value = "rate")

alt_future <- baseline %>% bind_rows(tibble(year = years[-1])) %>% 
  complete(year, name) %>% filter(!is.na(name)) %>% 
  gather(-year, -name, key = variable, value = value)

alt_future <- alt_future %>% left_join(alt_scenarios, by = c("variable", "name")) %>%
  arrange(year) %>% 
  group_by(name, variable) %>% 
  mutate(value = ifelse(! is.na(value), value,
                        value[1] * exp(rate * 0.01 * (year - year[1])))) %>%
  ungroup() %>%
  select(-rate) %>% spread(key = variable, value = value) %>%
  mutate(F = p * g * ef * 1E-6)



f <- function(country, year, var, alt = FALSE) {
  year <- enquo(year)
  fmt <- scales::label_comma(accuracy = 1)
  
  if (alt) {
    ff <- alt_future
  } else {
    ff <- future
  }
  
  ff %>% filter(year == !!year, name == country) %>%
    extract2(var) %>% 
    fmt()
}

r <- function(country, var, alt = FALSE) {
  fmt <- scales::label_percent(accuracy = 0.1)

  if (alt) {
    ss <- alt_scenarios
  } else {
    ss <- scenarios
  }

  x <- ss %>% filter(name == country, variable == var) %$% rate
  fmt(x / 100)
}

dr <- function(country, var) {
  fmt <- scales::label_percent(accuracy = 0.1)


    ss_alt <- alt_scenarios
    ss <- scenarios

  x0 <- scenarios %>% filter(name == country, variable == var) %$% rate
  x1 <- alt_scenarios  %>% filter(name == country, variable == var) %$% rate
  dx <- x1 - x0
  fmt(dx / 100)
}


rs <- function(country, var, sign = TRUE, alt = FALSE) {
  fmt <- scales::label_number(accuracy = 0.1)

  if (alt) {
    ss <- alt_scenarios
  } else {
    ss <- scenarios
  }

  x <- ss %>% filter(name == country, variable == var) %$% rate 
  s <- ifelse(x < 0, "-", "+")
  if (sign)
    str_c(s, fmt(abs(x)), sep = " ")
  else
    fmt(x)
} 

d <- function(country, year, var) {
  year <- enquo(year)
  fmt <- scales::label_comma(accuracy = 1)
  
  x <- future %>% filter(year == !!year, name == country) %>%
    extract2(var)
  y <- alt_future %>% filter(year == !!year, name == country) %>%
    extract2(var)
  fmt(y - x)
}

dp <- function(country, year, var) {
  year <- enquo(year)
  fmt <- scales::label_percent(accuracy = 1)
  
  x <- future %>% filter(year == !!year, name == country) %>%
    extract2(var)
  y <- alt_future %>% filter(year == !!year, name == country) %>%
    extract2(var)
  fmt((y - x) / x)
}

dr <- function(country, var) {
  fmt <- scales::label_percent(accuracy = 0.1)

  x <- scenarios %>% filter(name == country, variable == var) %$% rate
  y <- alt_scenarios %>% filter(name == country, variable == var) %$% rate
  fmt((y - x) / 100)
}


```

|                       |  2010    |  2050    | Growth rate |
|-----------------------|---------:|---------:|-------------------------:|
| _g_ (\$/person)       |  `r f("US", 2010, "g")`   |  `r f("US", 2050, "g")`  |  `r r("US", "g")`  |
| _ef_ (tons/$million)  |  `r f("US", 2010, "ef")`  |  `r f("US", 2050, "ef")` |  `r r("US", "ef")`  |
| _P_ (millions)        |  `r f("US", 2010, "p")`   |  `r f("US", 2050, "p")`  |  `r r("US", "p")`  |
| **Total Emissions** $F$<br/>(million tons CO~2~)   |  **`r f("US", 2010, "F")`** | **`r f("US", 2050, "F")`** | `r rs("US", "g", FALSE)` `r rs("US", "ef")` `r rs("US", "p")` = **`r r("US", "F", FALSE)`** |

<!--- ---> {#world-projections .center data-transition="fade" }
------

### Projections for future world emissions:

|                       |  2010    |  2050    | Growth rate |
|-----------------------|---------:|---------:|-------------------------:|
| _g_ (\$/person)       |  `r f("world", 2010, "g")`   |  `r f("world", 2050, "g")`  |  `r r("world", "g")`  |
| _ef_ (tons/$million)  |  `r f("world", 2010, "ef")`  |  `r f("world", 2050, "ef")` |  `r r("world", "ef")`  |
| _P_ (millions)        |  `r f("world", 2010, "p")`   |  `r f("world", 2050, "p")`  |  `r r("world", "p")`  |
| **Total Emissions** $F$<br/>(million tons CO~2~)   |  **`r f("world", 2010, "F")`** | **`r f("world", 2050, "F")`** | `r rs("world", "g", FALSE)` `r rs("world", "ef")` `r rs("world", "p")` = **`r r("world", "F", FALSE)`** |

## Uncertainties in Projections  {#model-uncertainties-2 data-transition="fade"}

### Projections for future world emissions: {.mtop-3}

|                       |  2010    |  2050    | 2100  |    Growth rate     |
|-----------------------|---------:|---------:|------:|-------------------:|
| _g_ (\$/person)       |  `r f("world", 2010, "g")`   |  `r f("world", 2050, "g")`  |  `r f("world", 2100, "g")`  |  `r r("world", "g")`  |
| _ef_ (tons/$million)  |  `r f("world", 2010, "ef")`   |  `r f("world", 2050, "ef")`  |  `r f("world", 2100, "ef")`  |  `r r("world", "ef")`  |
| _P_ (millions)        |  `r f("world", 2010, "p")`   |  `r f("world", 2050, "p")`  |  `r f("world", 2100, "p")`  |  `r r("world", "p")`  |
| **Total Emissions** $F$<br/>(million tons CO~2~)   |  **`r f("world", 2010, "F")`** | **`r f("world", 2050, "F")`** | **`r f("world", 2100, "F")`** | **`r r("world", "F")`** |

## Uncertainties in Projections {#higher-growth data-transition="fade"}

### Projections for future world emissions<br/>with slightly different growth rates: {.mtop-3}

|                       |  2010    |  2050    | 2100  |    Growth rate     | &Delta; rate |
|-----------------------|---------:|---------:|------:|-------------------:|--------------------:|
| _g_ (\$/person)       | `r f("world", 2010, "g", TRUE)`  | `r f("world", 2050, "g", TRUE)`  | `r f("world", 2100, "g", TRUE)`  | `r r("world", "g", TRUE)`  | `r dr("world", "g")` |
| _ef_ (tons/$million)  | `r f("world", 2010, "ef", TRUE)` | `r f("world", 2050, "ef", TRUE)` | `r f("world", 2100, "ef", TRUE)` | `r r("world", "ef", TRUE)` | `r dr("world", "ef")` |
| _P_ (millions)        | `r f("world", 2010, "p", TRUE)`  | `r f("world", 2050, "p", TRUE)`  | `r f("world", 2100, "p", TRUE)`  | `r r("world", "p", TRUE)`  | `r dr("world", "p")` |
| **Total Emissions** $F$<br/>(million tons CO~2~)   |  **`r f("world", 2010, "F", TRUE)`** | **`r f("world", 2050, "F", TRUE)`** | **`r f("world", 2100, "F", TRUE)`** | **`r r("world", "F", TRUE)`** | `r dr("world", "F")` |
| **Difference**        |                                  | **`r d("world", 2050, "F")`**    | **`r d("world", 2100, "F")`**    | **`r dr("world", "F")`** |
| **Difference (%)**    |                                  | **`r dp("world", 2050, "F")`**   | **`r dp("world", 2100, "F")`**   |             |
