---
title: "Climates of the Past"
class_no: 13
class_date: "Monday, February 22"
qrimage: qrcode.png
pageurl: "ees3310.jgilligan.org/slides/class_13"
pdfurl: "ees3310.jgilligan.org/slides/class_13/ees_3310_5310_class_13_slides.pdf"
course: "EES 3310/5310"
course_name: "Global Climate Change"
author: "Jonathan Gilligan"
semester: Spring
year: 2021
output:
  revealjg::revealjs_presentation
---
```{r setup, cache = F, echo = F, eval = T, message=F, warning=F}
knitr::opts_chunk$set(cache=TRUE, 
                      echo=FALSE, message=FALSE, warning=FALSE,
                      fig.height=10, fig.width=19, dpi=100,
                      dev='png',fig.path='assets/fig/',cache.path='./cache/')

library(rprojroot)

semester_dir <- find_rstudio_root_file()
data_dir <- file.path(semester_dir, "data")
script_dir <- file.path(semester_dir, "lecture_scripts")

source_semester_script <- function(script) {
  script_file <- file.path(script_dir, script)
  message("Running script", script_file)
  source(script_file, chdir = T)
}

eval_in_sem_script_dir <- function(expr, loc = script_dir) {
  this_dir <- getwd()
  setwd(loc)
  retval <- eval(expr)
  setwd(this_dir)
  invisible(retval)
}

library(magrittr)
library(tidyverse)

source_semester_script('lecture_utils.R')

source_semester_script('paleo_co2.R')
source_semester_script('henry_co2.R')
source_semester_script('geocarb.R')

source_semester_script('berkeley.R')
source_semester_script('strat.R')
source_semester_script('Temp_TSI.R')
source_semester_script('knit_keeling.R')
source_semester_script('paleo_co2.R')
```
# Mineral Weathering {#weathering-sec .center}

```{r load_carbonate_spike, echo=FALSE, warning=FALSE, include=FALSE}
co2.spike <- read.table(file.path(data_dir, 'carbon_cycle', 'spike_3000.txt'),header=T, stringsAsFactors=FALSE)
```
```{r calc_carbonate_spike, echo=FALSE, warning=FALSE, include=FALSE}
pco2.org <- co2.spike$pCO2[1]
delta.co2.0 <- (co2.spike %>% filter(year == 0))$pCO2 - pco2.org
delta.co2.300 <- (co2.spike %>% filter(year == 300))$pCO2 - pco2.org
delta.co2.1k <- (co2.spike %>% filter(year == 1000))$pCO2 - pco2.org
delta.co2.5k <- (co2.spike %>% filter(year == 5000))$pCO2 - pco2.org
delta.co2.10k <- (co2.spike %>% filter(year == 1E4))$pCO2 - pco2.org
delta.co2.100k <- (co2.spike %>% filter(year == 1E5))$pCO2 - pco2.org

pct.300  <- 100 * delta.co2.300  / delta.co2.0
pct.1k   <- 100 * delta.co2.1k   / delta.co2.0
pct.5k   <- 100 * delta.co2.5k   / delta.co2.0
pct.10k  <- 100 * delta.co2.10k  / delta.co2.0
pct.100k <- 100 * delta.co2.100k / delta.co2.0
```

## Carbonate vs. Silicate Weathering {#carbonate-silicate-comparison .eighty}

* {+} **Carbonate Weathering:**
  * {+} Dissolves carbonate minerals on land
  * {+} Increases ocean carbonate
    * {+} Adds _twice as much carbonate_ to oceans as silicate weathering
    * {+} Relieves ocean acidification
    * {+} Increases transfer of CO~2~ from atmosphere to ocean
    * {+} Creates carbonate rocks on sea floor 
      with carbon that originated on land
  * {+} Does not transform atmospheric CO~2~ to rocks
* {+} **Silicate Weathering:**
  * {+} Transforms carbon dioxide in atmosphere into rocks
    * Creates carbonate rocks on sea floor<br/>with 
      carbon that originated in atmosphere

## Weathering as Thermostat  {#thermostat-2-1 .eightyfive}

CO~2~ concentration is controlled by the balance of
<br/>volcanic outgassing and chemical weathering

::: {.mtop-3}
* {+} **Higher temperatures:**
  * More rain, faster chemical reactions
  * Faster weathering
  * Atmospheric \(\COO\) falls
* {+} **Lower temperatures**
  * Less rain, slower chemical reactions
  * Slower weathering
  * Atmospheric \(\COO\) rises
:::

## Temperature of Earth {#temperature-recap}

::: {.mtop-3}
* Weathering acts as thermostat.
* {+} Earth's temperature has been remarkably stable over time.
  * {+} 4 billion years ago, sun was 30% dimmer...
  * {+} With today's greenhouse effect the earth would have been frozen
  * {+} But there has constantly been liquid water.
  * {+} Early earth had more greenhouse gases (thermostat)
* {+} Geologic change alters thermostat "setting":
  * {+} Volcanic outgassing
  * {+} Land surface (e.g., mountain ranges)
  * {+} Vascular plants
* {+} In the long run, silicate thermostat will fix global warming...
  * {+} ...but it will take tens to hundreds of thousands of years.
:::

## Prospects for future: {#future-prospects}

* {+} **Oceanic sinks:**
  * {+} A few centuries:
    * Around `r signif(100 - pct.300,1)`% of excess \(\COO\) dissolves into oceans
    * {+} Dissolution stops as oceans acidify
  * {+} A few thousand years:
    * Reactions with limestone restore \(\pH\), \(\COO\) solubility
  * {+} Hundreds of thousands of years
    * Silicate-mineral weathering removes and buries excess \(\COO\).
* {+} **Bottom line:**
  * CO~2~ stays in the atmosphere many thousands of years after we stop
    burning fossil fuels.

# {#co2-lifetime-plot data-background-color="white" data-background="assets/images/ar10f03.png" data-background-size="contain"}

# CO~2~ vs. Methane {#methane.lifetime}

* \(\COO\):
  * After 1000 years, around `r signif(pct.1k,1)`%
    of excess \(\COO\) remains in atmosphere
  * After 10,000 years, `r round(pct.10k)`% remains
  * After 100,000 years, `r round(pct.100k)`% remains
* {+} Methane (\(\methane\)):
  * `r round(86 * (12 + 4) / (12 + 32))` times more powerful (molecule-for-molecule) than \(\COO\)
  * {+} Atmospheric lifetime: 12.4 years:
    * {+} After 25 years, `r round(100 * exp(-25/12.4))`% remains.
    * {+} After 100 years, `r round(100 * exp(-100/12.4),3)`% remains.

# Climates of the Past  {#past_climates_sec .center data-transition="fade-out"}

## Climates of the Past  {#past_climates_0 data-transition="fade"}

![Climate in deep time](assets/images/deep_climate_0.jpg){style="height:900px;"}

## Climates of the Past  {#past_climates_1 data-transition="fade"}

![Climate in deep time](assets/images/deep_climate_1.jpg){style="height:900px;" }

## Climates of the Past  {#past_climates_2 data-transition="fade-in"}

![Climate in deep time](assets/images/deep_climate_2.jpg){style="height:900px;" }

# Digging into the past  {#digging_sec data-transition="fade-out"}

## Digging into the past:   {#digging data-transition="fade-in"}

:::::: {.columns .vcenter}
::: {.column .centertext .pright-1}
Temperature measuring stations over the last 
`r scales::label_number(accuracy = 10)(year(today()) - 1890)` years.
:::
::: {.column .textleft}
![Temperature monitoring station map](assets/images/thermometer_history.png){.bare style="height:900px;"}
:::
::::::

## Surface Temperature Monitoring

:::::: {.columns }
::: {.column style="width:75%;"}
![Temperature monitoring stations](assets/images/current_temp_stations_1.png)
:::
::: {.column style="width:24%;vertical-align:bottom;font-size:75%;margin-bottom:1em;"}
* 7280 stations
* 2277 active
* 1656 > 100 years
:::
::::::

## Temperature Anomaly   {#anomaly_def .ninety data-transition="fade-out"}

* {+} **Global temperature change:**
  * {+} Average temperatures are different at different places.
  * {+} Temperatures change with the seasons
  * {+} How to compare temperature change between places with different climates?
* {+} **Temperature anomaly:**
  * {+} Define a reference time period (several decades)
  * {+} Anomaly = 
    [**actual temperature** at a place and time]{style="color:darkgreen;"}
    _minus_ 
    <br/>[**average temperature** at that place during reference period]{style="color:darkblue;"}

## Temperature Anomaly  {#anomaly_example .ninety data-transition="fade"}
```{r nashville_anomaly, include=FALSE}
tc <- 7.25 # Nashville avg temperature Jan 2020
tcavg <- 2.98 # Jan average 1950--1979
tc.month <- 'January'
tc.year <- 2020
anom <- tc - tcavg
```

* Anomaly = [**actual temperature** at a place and time]{style="color:darkgreen;"}
  _minus_ 
  <br/>[**average temperature** at that place during reference period]{style="color:darkblue;"}
* {+} **Example: Anomaly for Nashville, `r paste(tc.month, tc.year, sep=', ')`**
  *  Monthly avg. temp. for [`r paste(tc.month, tc.year, sep=', ')` = \(`r prt(tc,1)`^\circ\mathrm{C}\)]{style="color:darkblue;"}
  *  [Average `r tc.month` temp 1950--1979 = \(`r prt(tcavg,1)`^\circ\mathrm{C}\)]{style="color:darkgreen;"}
  *  Anomaly = \({\color{darkblue}`r prt(tc,1)`^\circ\mathrm{C}} - {\color{darkgreen}`r prt(tcavg,1)`^\circ\mathrm{C}} = `r prt(anom,1)`^\circ\mathrm{C}\)

```{r load_berkeley_temp, echo=F, eval=T, results='hide', message=FALSE, warning=FALSE}
berkeley_temp <- load_berkeley_temp()
berkeley_max_year <- max(berkeley_temp$year)
```
## Global Anomaly<br/>1850--`r berkeley_max_year` {.ninety data-transition="fade"}

```{r berkeley_temp, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 9, dependson="load_berkeley_temp"}
knit_berkeley_temp(berkeley_temp, 'global') + xlim(1850,berkeley_max_year + 0.99)
```

## North America<br/>1850--`r berkeley_max_year` {.ninety data-transition="fade"}

```{r berkeley_temp_north_america, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 9, dependson="load_berkeley_temp"}
knit_berkeley_temp(berkeley_temp, 'north_america') + xlim(1850,berkeley_max_year + 0.99)
```

## Continental US Anomaly<br/>1850--`r berkeley_max_year` {.ninety data-transition="fade"}

```{r berkeley_temp_conus, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 9, dependson="load_berkeley_temp"}
knit_berkeley_temp(berkeley_temp, 'conus') + xlim(1850,berkeley_max_year + 0.99) + ylim(-2.5,2.5)
```

## Tennessee Anomaly<br/>1850--`r berkeley_max_year` {.ninety data-transition="fade"}

```{r berkeley_temp_tn, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 9, dependson="load_berkeley_temp"}
berkeley_temp <- load_berkeley_temp()
knit_berkeley_temp(berkeley_temp, 'tn') + xlim(1850,berkeley_max_year + 0.99) + ylim(-2.5,2.5)
```

## Nashville Anomaly<br/>1850--`r berkeley_max_year` {.ninety data-transition="fade"}

```{r berkeley_temp_nash, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 9, dependson="load_berkeley_temp"}
berkeley_temp <- load_berkeley_temp()
knit_berkeley_temp(berkeley_temp, 'nashville') + xlim(1850,berkeley_max_year + 0.99) + ylim(-2.5,2.5)
```

# Ocean Temperatures {#ocean-tem-sec .center data-transition="fade-out"}

## Ocean Temperatures {#ocean-temp-argo-1 data-transition="fade"}

![](assets/images/argo_photo_1.png){style="height:900px;"}

## Ocean Temperatures {#ocean-temp-argo-deployment data-transition="fade"}

![](assets/images/argo_deployment_map_1.png){style="height:900px;"}

## Ocean Heat Content {#ocean-heat-content data-transition="fade"}

![](assets/images/heat_content2000m_2020.png){style="height:900px;"}

# Searching for<br/>a Smoking Gun: {#smoking-gun-sec .center}

## What caused the warming? {.center}

# Sunspots?  {#sunspots_sec data-transition="fade-out"}

## Sunspots?  {#sunspots data-transition="fade"}

:::::: {.columns .bare}
::: {.column .bare style="width:435px;"}
![](assets/images/acrimsat_sunspots.jpg){style="height:400px;"}
:::
::: {.column .ptop-3 .seventyfive style="width:66%;"}
### **Sunspots**

* Discovered 1611 by Galileo and J. Fabricius
* More sunspots \(\rightarrow\) brighter
* 11 year cycle
* Intensity changes:
  * <1% for 11-year cycle
  * <0.1% change in decadal average from little ice age to present
:::
::::::

```{r sunspot_cycles, echo=FALSE, warning=FALSE, fig.height=5}
tsi_hist <- read_table(file.path(data_dir, "solar", "historical_reconstruction.txt"), 
                       skip = 6) %>% 
  janitor::clean_names() %>% dplyr::rename(tsi = tsi_w_m_2)

sunspots <- read_table(file.path(data_dir, "solar", "sunspots.txt"), 
                       col_names = c("year", "sunspots"))
alt_sunspots <- read_table(file.path(data_dir, "solar", "alt_sunspots.txt"), 
                       col_names = c("year", "sunspots"))
sunspots <- bind_rows(sunspots, alt_sunspots) %>% group_by(year) %>%
  summarize(sunspots = mean(sunspots, na.rm = TRUE), .groups = "drop")

ggplot(sunspots, aes(x = year, y = sunspots)) + 
  geom_line(size = 1, color = "darkblue") +
  labs(x = "Year", y = "Annual Number of Sunspots") +
  theme_bw(base_size = 10) +
  annotate(geom = "label", x = 1675, y = 130, label = "Maunder Minimum\n(Little Ice Age)",
           color = "darkgreen", size = 8) +
  annotate(geom = "segment", x = 1675, xend = 1675, yend = 7, y = 110, color = "darkgreen",
           size = 2, arrow = arrow())
```

## Sunspots didn't cause recent warming {.ninety}

```{r sunspots, echo=FALSE, message=FALSE, warning=FALSE, cache=T}
source_semester_script('Temp_TSI.R')
knit_tsi()
```

# Fingerprints:<br/>Predictions and Patterns {#fingerprint-sec .center}

## Predictions: 1967

![](assets/images/manabe_wetherald.png){style="height:900px;"}

## Stratosphere vs. Surface:
```{r stratosphere, echo=FALSE, warning=FALSE, message=FALSE}
source_semester_script('strat.R')
plot_strat(data_dir = data_dir) + 
  theme(legend.background = element_blank(),
        legend.text = element_text(size = 15),
        legend.key.height = unit(0.7, "lines"),
        legend.position=c(1,1.1),
        legend.justification = c(1,1))
```

## Day vs. Night 

![Daytime vs. nighttime temperatures](assets/images/days_and_nights.png){style="height:900px;"}

